package com.itangcent.idea.plugin.api.export.postman

import com.google.inject.Inject
import com.intellij.openapi.actionSystem.DataContext
import com.itangcent.common.kit.toJson
import com.itangcent.common.model.Request
import com.itangcent.common.model.URL
import com.itangcent.common.utils.asDate
import com.itangcent.common.utils.formatDate
import com.itangcent.idea.plugin.Worker
import com.itangcent.idea.plugin.api.export.core.requestOnly
import com.itangcent.idea.plugin.settings.PostmanJson5FormatType
import com.itangcent.idea.plugin.settings.SettingBinder
import com.itangcent.idea.plugin.settings.Settings
import com.itangcent.idea.utils.GsonExUtils
import com.itangcent.idea.utils.SystemProvider
import com.itangcent.intellij.context.ActionContext
import com.itangcent.mock.ImmutableSystemProvider
import com.itangcent.mock.SettingBinderAdaptor
import com.itangcent.mock.toUnixString
import com.itangcent.test.TimeZoneKit.LOCAL_TIME_RAW_STRING
import com.itangcent.test.TimeZoneKit.LOCAL_TIME_YMS_STRING
import com.itangcent.test.TimeZoneKit.STANDARD_TIME
import com.itangcent.test.mock
import org.junit.jupiter.api.condition.OS

/**
 * Test case of [PostmanFormatter]
 */
internal class PostmanFormatterTest : PostmanSpringClassExporterBaseTest() {

    @Inject
    private lateinit var postmanFormatter: PostmanFormatter

    private lateinit var settings: Settings

    private val date = STANDARD_TIME.asDate().formatDate("EEE, dd MMM yyyyHH:mm:ss 'GMT'")

    override fun beforeBind() {
        super.beforeBind()
        settings = Settings()
        settings.inferEnable = true
    }

    override fun bind(builder: ActionContext.ActionContextBuilder) {
        super.bind(builder)
        builder.bind(SystemProvider::class) {
            it.toInstance(ImmutableSystemProvider(STANDARD_TIME))
        }
        builder.bind(SettingBinder::class) {
            it.toInstance(SettingBinderAdaptor(settings))
        }
        builder.bindInstance(PostmanApiHelper::class, PostmanCachedApiHelper())
        builder.mock(DataContext::class)
    }

    override fun afterBind() {
        super.afterBind()
        postmanFormatter.responseTimeGenerator = { 50 }
    }

    override fun shouldRunTest(): Boolean {
        return !OS.WINDOWS.isCurrentOs
    }

    /**
     * use json-schema by default
     */
    fun testRequest2Item() {
        settings.postmanJson5FormatType = PostmanJson5FormatType.NONE.name
        val requests = ArrayList<Request>()
        classExporter.export(userCtrlPsiClass, requestOnly {
            requests.add(it)
        })
        (classExporter as Worker).waitCompleted()
        assertEquals(
            "{\"request\":{\"method\":\"GET\",\"description\":\"not update anything\",\"header\":[],\"url\":{\"path\":[\"user\",\"greeting\"],\"query\":[],\"host\":\"{{test_default}}\",\"raw\":\"{{test_default}}/user/greeting\"}},\"response\":[{\"originalRequest\":{\"method\":\"GET\",\"description\":\"not update anything\",\"header\":[],\"url\":{\"path\":[\"user\",\"greeting\"],\"query\":[],\"host\":\"{{test_default}}\",\"raw\":\"{{test_default}}/user/greeting\"}},\"_postman_previewlanguage\":\"json\",\"code\":200,\"_postman_previewtype\":\"text\",\"responseTime\":50,\"name\":\"say hello-Example\",\"header\":[{\"name\":\"date\",\"key\":\"date\",\"value\":\"$date\",\"description\":\"The date and time that the message was sent\"},{\"name\":\"server\",\"key\":\"server\",\"value\":\"Apache-Coyote/1.1\",\"description\":\"A name for the server\"},{\"name\":\"transfer-encoding\",\"key\":\"transfer-encoding\",\"value\":\"chunked\",\"description\":\"The form of encoding used to safely transfer the entity to the user. Currently defined methods are: chunked, compress, deflate, gzip, identity.\"},{\"name\":\"content-type\",\"key\":\"content-type\",\"value\":\"application/json;charset\\u003dUTF-8\"}],\"body\":\"\",\"status\":\"OK\"}],\"name\":\"say hello\",\"event\":[{\"listen\":\"prerequest\",\"script\":{\"exec\":[\"pm.environment.set(\\\"token\\\", \\\"123456\\\");\"],\"type\":\"text/javascript\"}},{\"listen\":\"test\",\"script\":{\"exec\":[\"pm.test(\\\"Successful POST request\\\", function () {\",\"pm.expect(pm.response.code).to.be.oneOf([201,202]);\",\"});\"],\"type\":\"text/javascript\"}}]}",
            postmanFormatter.request2Item(requests[0]).toJson()!!.toUnixString()
        )
        assertEquals(
            "{\"request\":{\"method\":\"GET\",\"description\":\"\",\"header\":[{\"key\":\"token\",\"value\":\"\",\"type\":\"text\",\"description\":\"auth token\"}],\"url\":{\"path\":[\"user\",\"get\",\":id\"],\"query\":[{\"key\":\"id\",\"value\":\"0\",\"equals\":true,\"description\":\"user id\"}],\"host\":\"{{test_default}}\",\"raw\":\"{{test_default}}/user/get/{id}\"}},\"response\":[{\"originalRequest\":{\"method\":\"GET\",\"description\":\"\",\"header\":[{\"key\":\"token\",\"value\":\"\",\"type\":\"text\",\"description\":\"auth token\"}],\"url\":{\"path\":[\"user\",\"get\",\":id\"],\"query\":[{\"key\":\"id\",\"value\":\"0\",\"equals\":true,\"description\":\"user id\"}],\"host\":\"{{test_default}}\",\"raw\":\"{{test_default}}/user/get/{id}\"}},\"_postman_previewlanguage\":\"json\",\"code\":200,\"_postman_previewtype\":\"text\",\"responseTime\":50,\"name\":\"get user info-Example\",\"header\":[{\"name\":\"date\",\"key\":\"date\",\"value\":\"$date\",\"description\":\"The date and time that the message was sent\"},{\"name\":\"server\",\"key\":\"server\",\"value\":\"Apache-Coyote/1.1\",\"description\":\"A name for the server\"},{\"name\":\"transfer-encoding\",\"key\":\"transfer-encoding\",\"value\":\"chunked\",\"description\":\"The form of encoding used to safely transfer the entity to the user. Currently defined methods are: chunked, compress, deflate, gzip, identity.\"},{\"name\":\"content-type\",\"key\":\"content-type\",\"value\":\"application/json;charset\\u003dUTF-8\"}],\"body\":\"{\\n  \\\"code\\\": 0,\\n  \\\"msg\\\": \\\"success\\\",\\n  \\\"data\\\": {\\n    \\\"id\\\": 0,\\n    \\\"type\\\": 0,\\n    \\\"name\\\": \\\"Tony Stark\\\",\\n    \\\"age\\\": 45,\\n    \\\"sex\\\": 0,\\n    \\\"birthDay\\\": \\\"\\\",\\n    \\\"regtime\\\": \\\"\\\"\\n  }\\n}\",\"status\":\"OK\"}],\"name\":\"get user info\",\"event\":[{\"listen\":\"prerequest\",\"script\":{\"exec\":[\"pm.environment.set(\\\"token\\\", \\\"123456\\\");\"],\"type\":\"text/javascript\"}},{\"listen\":\"test\",\"script\":{\"exec\":[\"pm.test(\\\"Successful POST request\\\", function () {\",\"pm.expect(pm.response.code).to.be.oneOf([201,202]);\",\"});\"],\"type\":\"text/javascript\"}}]}",
            postmanFormatter.request2Item(requests[1]).toJson()!!.toUnixString()
        )
    }

    /**
     * use json5
     */
    fun testRequest2ItemWithJson5() {
        settings.postmanJson5FormatType = PostmanJson5FormatType.ALL.name
        val requests = ArrayList<Request>()
        classExporter.export(userCtrlPsiClass, requestOnly {
            requests.add(it)
        })
        (classExporter as Worker).waitCompleted()
        assertEquals(
            "{\"request\":{\"method\":\"GET\",\"description\":\"not update anything\",\"header\":[],\"url\":{\"path\":[\"user\",\"greeting\"],\"query\":[],\"host\":\"{{test_default}}\",\"raw\":\"{{test_default}}/user/greeting\"}},\"response\":[{\"originalRequest\":{\"method\":\"GET\",\"description\":\"not update anything\",\"header\":[],\"url\":{\"path\":[\"user\",\"greeting\"],\"query\":[],\"host\":\"{{test_default}}\",\"raw\":\"{{test_default}}/user/greeting\"}},\"_postman_previewlanguage\":\"json\",\"code\":200,\"_postman_previewtype\":\"text\",\"responseTime\":50,\"name\":\"say hello-Example\",\"header\":[{\"name\":\"date\",\"key\":\"date\",\"value\":\"$date\",\"description\":\"The date and time that the message was sent\"},{\"name\":\"server\",\"key\":\"server\",\"value\":\"Apache-Coyote/1.1\",\"description\":\"A name for the server\"},{\"name\":\"transfer-encoding\",\"key\":\"transfer-encoding\",\"value\":\"chunked\",\"description\":\"The form of encoding used to safely transfer the entity to the user. Currently defined methods are: chunked, compress, deflate, gzip, identity.\"},{\"name\":\"content-type\",\"key\":\"content-type\",\"value\":\"application/json;charset\\u003dUTF-8\"}],\"body\":\"\\\"\\\"\",\"status\":\"OK\"}],\"name\":\"say hello\",\"event\":[{\"listen\":\"prerequest\",\"script\":{\"exec\":[\"pm.environment.set(\\\"token\\\", \\\"123456\\\");\"],\"type\":\"text/javascript\"}},{\"listen\":\"test\",\"script\":{\"exec\":[\"pm.test(\\\"Successful POST request\\\", function () {\",\"pm.expect(pm.response.code).to.be.oneOf([201,202]);\",\"});\"],\"type\":\"text/javascript\"}}]}",
            postmanFormatter.request2Item(requests[0]).toJson()!!.toUnixString()
        )
        assertEquals(
            "{\"request\":{\"method\":\"GET\",\"description\":\"\",\"header\":[{\"key\":\"token\",\"value\":\"\",\"type\":\"text\",\"description\":\"auth token\"}],\"url\":{\"path\":[\"user\",\"get\",\":id\"],\"query\":[{\"key\":\"id\",\"value\":\"0\",\"equals\":true,\"description\":\"user id\"}],\"host\":\"{{test_default}}\",\"raw\":\"{{test_default}}/user/get/{id}\"}},\"response\":[{\"originalRequest\":{\"method\":\"GET\",\"description\":\"\",\"header\":[{\"key\":\"token\",\"value\":\"\",\"type\":\"text\",\"description\":\"auth token\"}],\"url\":{\"path\":[\"user\",\"get\",\":id\"],\"query\":[{\"key\":\"id\",\"value\":\"0\",\"equals\":true,\"description\":\"user id\"}],\"host\":\"{{test_default}}\",\"raw\":\"{{test_default}}/user/get/{id}\"}},\"_postman_previewlanguage\":\"json\",\"code\":200,\"_postman_previewtype\":\"text\",\"responseTime\":50,\"name\":\"get user info-Example\",\"header\":[{\"name\":\"date\",\"key\":\"date\",\"value\":\"$date\",\"description\":\"The date and time that the message was sent\"},{\"name\":\"server\",\"key\":\"server\",\"value\":\"Apache-Coyote/1.1\",\"description\":\"A name for the server\"},{\"name\":\"transfer-encoding\",\"key\":\"transfer-encoding\",\"value\":\"chunked\",\"description\":\"The form of encoding used to safely transfer the entity to the user. Currently defined methods are: chunked, compress, deflate, gzip, identity.\"},{\"name\":\"content-type\",\"key\":\"content-type\",\"value\":\"application/json;charset\\u003dUTF-8\"}],\"body\":\"{\\n    \\\"code\\\": 0, //response code\\n    \\\"msg\\\": \\\"success\\\", //message\\n    \\\"data\\\": { //response data\\n        \\\"id\\\": 0, //user id\\n        /**\\n         * user type\\n         * 1 :administration\\n         * 2 :a person, an animal or a plant\\n         * 3 :Anonymous visitor\\n         */\\n        \\\"type\\\": 0,\\n        \\\"name\\\": \\\"Tony Stark\\\", //user name\\n        \\\"age\\\": 45, //user age\\n        \\\"sex\\\": 0,\\n        \\\"birthDay\\\": \\\"\\\", //user birthDay\\n        \\\"regtime\\\": \\\"\\\" //user regtime\\n    }\\n}\",\"status\":\"OK\"}],\"name\":\"get user info\",\"event\":[{\"listen\":\"prerequest\",\"script\":{\"exec\":[\"pm.environment.set(\\\"token\\\", \\\"123456\\\");\"],\"type\":\"text/javascript\"}},{\"listen\":\"test\",\"script\":{\"exec\":[\"pm.test(\\\"Successful POST request\\\", function () {\",\"pm.expect(pm.response.code).to.be.oneOf([201,202]);\",\"});\"],\"type\":\"text/javascript\"}}]}",
            postmanFormatter.request2Item(requests[1]).toJson()!!.toUnixString()
        )
    }

    fun testItem2Request() {
        val api = GsonExUtils.fromJson<HashMap<String, Any?>>(
            "{\"request\":{\"method\":\"GET\",\"header\":[{\"description\":\"The authentication Token\",\"type\":\"text\",\"value\":\"\",\"key\":\"token\"}],\"url\":{\"path\":[\"user\",\"get\"],\"query\":[{\"description\":\"user id type:long\",\"value\":\"0\",\"key\":\"id\"}],\"host\":[\"{{user}}\"],\"raw\":\"{{user}}/user/get?id\\u003d0\"}},\"response\":[{\"originalRequest\":{\"method\":\"GET\",\"header\":[{\"description\":\"The authentication Token\",\"type\":\"text\",\"value\":\"\",\"key\":\"token\"}],\"url\":{\"path\":[\"user\",\"get\"],\"query\":[{\"description\":\"user id type:long\",\"value\":\"0\",\"key\":\"id\"}],\"host\":[\"{{user}}\"],\"raw\":\"{{user}}/user/get?id\\u003d0\"}},\"_postman_previewlanguage\":\"json\",\"code\":200,\"cookie\":[],\"responseTime\":\"38\",\"name\":\"get user info by user ID-Example\",\"header\":[{\"name\":\"date\",\"description\":\"The date and time that the message was sent\",\"value\":\"Wed, 25 Aug 202113:06:00 GMT\",\"key\":\"date\"},{\"name\":\"server\",\"description\":\"A name for the server\",\"value\":\"Apache-Coyote/1.1\",\"key\":\"server\"},{\"name\":\"transfer-encoding\",\"description\":\"The form of encoding used to safely transfer the entity to the user. Currently defined methods are: chunked, compress, deflate, gzip, identity.\",\"value\":\"chunked\",\"key\":\"transfer-encoding\"},{\"name\":\"content-type\",\"value\":\"application/json;charset\\u003dUTF-8\",\"key\":\"content-type\"}],\"id\":\"88cc98be-e4a6-4fcd-a189-6d1a307cf334\",\"body\":\"{}\",\"status\":\"OK\"}],\"name\":\"get user info by user ID\",\"id\":\"1e310fdd-e944-4a5e-83e2-d4b8778e1763\",\"event\":[{\"listen\":\"prerequest\",\"script\":{\"type\":\"text/javascript\",\"exec\":[\"var a \\u003d \\\"1\\\";\",\"var b \\u003d \\\"1\\\";\"]}},{\"listen\":\"test\",\"script\":{\"type\":\"text/javascript\",\"exec\":[\"var a \\u003d \\\"1\\\";\",\"var b \\u003d \\\"1\\\";\"]}}]}"
        )!!
        val request = postmanFormatter.item2Request(api)!!
        assertEquals("get user info by user ID", request.name)
        assertEquals("GET", request.method)
        assertEquals(URL.of("user/get"), request.path)
        assertEquals(
            "[{\"name\":\"token\",\"value\":\"\",\"desc\":\"The authentication Token\"}]",
            request.headers.toJson()
        )
        assertEquals("[{\"name\":\"id\",\"value\":\"0\",\"desc\":\"user id type:long\"}]", request.querys.toJson())

        val api2 = GsonExUtils.fromJson<HashMap<String, Any?>>(
            "{\"request\":{\"method\":\"POST\",\"header\":[{\"type\":\"text\",\"value\":\"application/json\",\"key\":\"Content-Type\"},{\"description\":\"The authentication Token\",\"type\":\"text\",\"value\":\"\",\"key\":\"token\"}],\"body\":{\"mode\":\"raw\",\"options\":{\"raw\":{\"language\":\"json\"}},\"raw\":\"{\\n  \\\"id\\\": 0,\\n  \\\"type\\\": 0,\\n  \\\"name\\\": \\\"\\\",\\n  \\\"age\\\": 0,\\n  \\\"sex\\\": 0,\\n  \\\"birthDay\\\": \\\"\\\",\\n  \\\"regtime\\\": \\\"\\\"\\n}\"},\"url\":{\"path\":[\"user\",\"add\"],\"host\":[\"{{user}}\"],\"raw\":\"{{user}}/user/add\"}},\"response\":[{\"originalRequest\":{\"method\":\"POST\",\"header\":[{\"type\":\"text\",\"value\":\"application/json\",\"key\":\"Content-Type\"},{\"description\":\"The authentication Token\",\"type\":\"text\",\"value\":\"\",\"key\":\"token\"}],\"body\":{\"mode\":\"raw\",\"options\":{\"raw\":{\"language\":\"json\"}},\"raw\":\"{\\n  \\\"id\\\": 0,\\n  \\\"type\\\": 0,\\n  \\\"name\\\": \\\"\\\",\\n  \\\"age\\\": 0,\\n  \\\"sex\\\": 0,\\n  \\\"birthDay\\\": \\\"\\\",\\n  \\\"regtime\\\": \\\"\\\"\\n}\"},\"url\":{\"host\":[\"{{user}}\"],\"raw\":\"{{user}}\"}},\"_postman_previewlanguage\":\"json\",\"code\":200,\"cookie\":[],\"responseTime\":\"63\",\"name\":\"create an user-Example\",\"header\":[{\"name\":\"date\",\"description\":\"The date and time that the message was sent\",\"value\":\"Wed, 25 Aug 202113:06:00 GMT\",\"key\":\"date\"},{\"name\":\"server\",\"description\":\"A name for the server\",\"value\":\"Apache-Coyote/1.1\",\"key\":\"server\"},{\"name\":\"transfer-encoding\",\"description\":\"The form of encoding used to safely transfer the entity to the user. Currently defined methods are: chunked, compress, deflate, gzip, identity.\",\"value\":\"chunked\",\"key\":\"transfer-encoding\"},{\"name\":\"content-type\",\"value\":\"application/json;charset\\u003dUTF-8\",\"key\":\"content-type\"}],\"id\":\"b5f59298-e871-491f-b082-35bd2589c7b2\",\"body\":\"{\\n  \\\"code\\\": 0,\\n  \\\"msg\\\": \\\"\\\",\\n  \\\"data\\\": {\\n    \\\"id\\\": 0,\\n    \\\"type\\\": 0,\\n    \\\"name\\\": \\\"\\\",\\n    \\\"age\\\": 0,\\n    \\\"sex\\\": 0,\\n    \\\"birthDay\\\": \\\"\\\",\\n    \\\"regtime\\\": \\\"\\\"\\n  }\\n}\",\"status\":\"OK\"}],\"name\":\"create an user\",\"id\":\"d0142157-7f1f-49d8-9b73-a9e6c745deb4\",\"event\":[{\"listen\":\"prerequest\",\"script\":{\"type\":\"text/javascript\",\"exec\":[\"var a \\u003d \\\"1\\\";\",\"var b \\u003d \\\"1\\\";\"]}},{\"listen\":\"test\",\"script\":{\"type\":\"text/javascript\",\"exec\":[\"var a \\u003d \\\"1\\\";\",\"var b \\u003d \\\"1\\\";\"]}}]}"
        )!!
        val request2 = postmanFormatter.item2Request(api2)!!
        assertEquals("create an user", request2.name)
        assertEquals("POST", request2.method)
        assertEquals(URL.of("user/add"), request2.path)
        assertEquals(
            "[{\"name\":\"Content-Type\",\"value\":\"application/json\"},{\"name\":\"token\",\"value\":\"\",\"desc\":\"The authentication Token\"}]",
            request2.headers.toJson()
        )
        assertNull(request2.querys)
        assertEquals(
            "{\"regtime\":\"\",\"birthDay\":\"\",\"sex\":0,\"name\":\"\",\"id\":0,\"type\":0,\"age\":0}",
            request2.body.toJson()
        )
        assertEquals(
            "json",
            request2.bodyType
        )

        val api3 = GsonExUtils.fromJson<HashMap<String, Any?>>(
            "{\"request\":{\"method\":\"PUT\",\"header\":[{\"type\":\"text\",\"value\":\"application/x-www-form-urlencoded\",\"key\":\"Content-Type\"},{\"description\":\"The authentication Token\",\"type\":\"text\",\"value\":\"\",\"key\":\"token\"}],\"url\":{\"path\":[\"user\",\"update\"],\"query\":[{\"description\":\"user id\",\"value\":\"0\",\"key\":\"id\"},{\"description\":\"user type\\n1 :ADMIN\\n2 :MEMBER\\n3 :GUEST\",\"value\":\"0\",\"key\":\"type\"},{\"description\":\"name of user\",\"value\":\"\",\"key\":\"name\"},{\"description\":\"age of user\",\"value\":\"0\",\"key\":\"age\"},{\"description\":\"「deprecated」It\\u0027s a secret\",\"value\":\"0\",\"key\":\"sex\"},{\"description\":\"birthDay of user\",\"value\":\"\",\"key\":\"birthDay\"},{\"description\":\"注册时间\",\"value\":\"\",\"key\":\"regtime\"}],\"host\":[\"{{user}}\"],\"raw\":\"{{user}}/user/update?id\\u003d0\\u0026type\\u003d0\\u0026name\\u003d\\u0026age\\u003d0\\u0026sex\\u003d0\\u0026birthDay\\u003d\\u0026regtime\\u003d\"}},\"response\":[{\"originalRequest\":{\"method\":\"PUT\",\"header\":[{\"type\":\"text\",\"value\":\"application/x-www-form-urlencoded\",\"key\":\"Content-Type\"},{\"description\":\"The authentication Token\",\"type\":\"text\",\"value\":\"\",\"key\":\"token\"}],\"url\":{\"path\":[\"user\",\"update\"],\"query\":[{\"description\":\"user id\",\"value\":\"0\",\"key\":\"id\"},{\"description\":\"user type\\n1 :ADMIN\\n2 :MEMBER\\n3 :GUEST\",\"value\":\"0\",\"key\":\"type\"},{\"description\":\"name of user\",\"value\":\"\",\"key\":\"name\"},{\"description\":\"age of user\",\"value\":\"0\",\"key\":\"age\"},{\"description\":\"「deprecated」It\\u0027s a secret\",\"value\":\"0\",\"key\":\"sex\"},{\"description\":\"birthDay of user\",\"value\":\"\",\"key\":\"birthDay\"},{\"description\":\"注册时间\",\"value\":\"\",\"key\":\"regtime\"}],\"host\":[\"{{user}}\"],\"raw\":\"{{user}}/user/update?id\\u003d0\\u0026type\\u003d0\\u0026name\\u003d\\u0026age\\u003d0\\u0026sex\\u003d0\\u0026birthDay\\u003d\\u0026regtime\\u003d\"}},\"_postman_previewlanguage\":\"json\",\"code\":200,\"cookie\":[],\"responseTime\":\"66\",\"name\":\"update user info-Example\",\"header\":[{\"name\":\"date\",\"description\":\"The date and time that the message was sent\",\"value\":\"Wed, 25 Aug 202113:06:00 GMT\",\"key\":\"date\"},{\"name\":\"server\",\"description\":\"A name for the server\",\"value\":\"Apache-Coyote/1.1\",\"key\":\"server\"},{\"name\":\"transfer-encoding\",\"description\":\"The form of encoding used to safely transfer the entity to the user. Currently defined methods are: chunked, compress, deflate, gzip, identity.\",\"value\":\"chunked\",\"key\":\"transfer-encoding\"},{\"name\":\"content-type\",\"value\":\"application/json;charset\\u003dUTF-8\",\"key\":\"content-type\"}],\"id\":\"d638003a-a82a-44d9-ade2-d35d3461f314\",\"body\":\"{}\",\"status\":\"OK\"}],\"name\":\"update user info\",\"id\":\"7235169a-6610-436e-bb1b-b79daf4f5ffb\",\"event\":[{\"listen\":\"prerequest\",\"script\":{\"type\":\"text/javascript\",\"exec\":[\"var a \\u003d \\\"1\\\";\",\"var b \\u003d \\\"1\\\";\"]}},{\"listen\":\"test\",\"script\":{\"type\":\"text/javascript\",\"exec\":[\"var a \\u003d \\\"1\\\";\",\"var b \\u003d \\\"1\\\";\"]}}]}"
        )!!
        val request3 = postmanFormatter.item2Request(api3)!!
        assertEquals("update user info", request3.name)
        assertEquals("PUT", request3.method)
        assertEquals(URL.of("user/update"), request3.path)
        assertEquals(
            "[{\"name\":\"Content-Type\",\"value\":\"application/x-www-form-urlencoded\"},{\"name\":\"token\",\"value\":\"\",\"desc\":\"The authentication Token\"}]",
            request3.headers.toJson()
        )
        assertEquals(
            "[{\"name\":\"id\",\"value\":\"0\",\"desc\":\"user id\"},{\"name\":\"type\",\"value\":\"0\",\"desc\":\"user type\\n1 :ADMIN\\n2 :MEMBER\\n3 :GUEST\"},{\"name\":\"name\",\"value\":\"\",\"desc\":\"name of user\"},{\"name\":\"age\",\"value\":\"0\",\"desc\":\"age of user\"},{\"name\":\"sex\",\"value\":\"0\",\"desc\":\"「deprecated」It\\u0027s a secret\"},{\"name\":\"birthDay\",\"value\":\"\",\"desc\":\"birthDay of user\"},{\"name\":\"regtime\",\"value\":\"\",\"desc\":\"注册时间\"}]",
            request3.querys.toJson()
        )

        val api4 = GsonExUtils.fromJson<HashMap<String, Any?>>(
            "{\"protocolProfileBehavior\":{\"disableBodyPruning\":true},\"request\":{\"method\":\"POST\",\"header\":[{\"type\":\"text\",\"value\":\"multipart/form-data\",\"key\":\"Content-Type\"},{\"description\":\"The authentication Token\",\"type\":\"text\",\"value\":\"\",\"key\":\"token\"}],\"body\":{\"mode\":\"formdata\",\"formdata\":[{\"description\":\"profile img of user\",\"type\":\"file\",\"key\":\"profileImg\"},{\"description\":\"user id\",\"type\":\"text\",\"value\":\"0\",\"key\":\"id\"},{\"description\":\"user type\\n1 :ADMIN\\n2 :MEMBER\\n3 :GUEST\",\"type\":\"text\",\"value\":\"0\",\"key\":\"type\"},{\"description\":\"name of user\",\"type\":\"text\",\"value\":\"\",\"key\":\"name\"},{\"description\":\"age of user\",\"type\":\"text\",\"value\":\"0\",\"key\":\"age\"},{\"description\":\"「deprecated」It\\u0027s a secret\",\"type\":\"text\",\"value\":\"0\",\"key\":\"sex\"},{\"description\":\"birthDay of user\",\"type\":\"text\",\"value\":\"\",\"key\":\"birthDay\"},{\"description\":\"注册时间\",\"type\":\"text\",\"value\":\"\",\"key\":\"regtime\"}]},\"url\":{\"path\":[\"file\",\"add\"],\"host\":[\"{{user}}\"],\"raw\":\"{{user}}/file/add\"}},\"response\":[{\"originalRequest\":{\"method\":\"POST\",\"header\":[{\"type\":\"text\",\"value\":\"multipart/form-data\",\"key\":\"Content-Type\"},{\"description\":\"The authentication Token\",\"type\":\"text\",\"value\":\"\",\"key\":\"token\"}],\"body\":{\"mode\":\"formdata\",\"formdata\":[{\"description\":\"profile img of user\",\"type\":\"file\",\"key\":\"profileImg\"},{\"description\":\"user id\",\"type\":\"text\",\"value\":\"0\",\"key\":\"id\"},{\"description\":\"user type\\n1 :ADMIN\\n2 :MEMBER\\n3 :GUEST\",\"type\":\"text\",\"value\":\"0\",\"key\":\"type\"},{\"description\":\"name of user\",\"type\":\"text\",\"value\":\"\",\"key\":\"name\"},{\"description\":\"age of user\",\"type\":\"text\",\"value\":\"0\",\"key\":\"age\"},{\"description\":\"「deprecated」It\\u0027s a secret\",\"type\":\"text\",\"value\":\"0\",\"key\":\"sex\"},{\"description\":\"birthDay of user\",\"type\":\"text\",\"value\":\"\",\"key\":\"birthDay\"},{\"description\":\"注册时间\",\"type\":\"text\",\"value\":\"\",\"key\":\"regtime\"}]},\"url\":{\"path\":[\"file\",\"add\"],\"host\":[\"{{user}}\"],\"raw\":\"{{user}}/file/add\"}},\"_postman_previewlanguage\":\"json\",\"code\":200,\"cookie\":[],\"responseTime\":\"99\",\"name\":\"create an user(上传profile img of user)-Example\",\"header\":[{\"name\":\"date\",\"description\":\"The date and time that the message was sent\",\"value\":\"Wed, 25 Aug 202120:46:39 GMT\",\"key\":\"date\"},{\"name\":\"server\",\"description\":\"A name for the server\",\"value\":\"Apache-Coyote/1.1\",\"key\":\"server\"},{\"name\":\"transfer-encoding\",\"description\":\"The form of encoding used to safely transfer the entity to the user. Currently defined methods are: chunked, compress, deflate, gzip, identity.\",\"value\":\"chunked\",\"key\":\"transfer-encoding\"},{\"name\":\"content-type\",\"value\":\"application/json;charset\\u003dUTF-8\",\"key\":\"content-type\"}],\"id\":\"a7ae6bbf-80e5-4a74-9491-49a314bdc9d7\",\"body\":\"{}\",\"status\":\"OK\"}],\"name\":\"create an user\",\"id\":\"5b843baf-f9c7-4b25-b206-bf6aea45d4d3\"}"
        )!!
        val request4 = postmanFormatter.item2Request(api4)!!
        assertEquals("create an user", request4.name)
        assertEquals("POST", request4.method)
        assertEquals(URL.of("file/add"), request4.path)
        assertEquals(
            "[{\"name\":\"Content-Type\",\"value\":\"multipart/form-data\"},{\"name\":\"token\",\"value\":\"\",\"desc\":\"The authentication Token\"}]",
            request4.headers.toJson()
        )
        assertNull(request4.querys.toJson())
        assertEquals(
            "[{\"name\":\"profileImg\",\"desc\":\"profile img of user\",\"type\":\"file\"},{\"name\":\"id\",\"value\":\"0\",\"desc\":\"user id\",\"type\":\"text\"},{\"name\":\"type\",\"value\":\"0\",\"desc\":\"user type\\n1 :ADMIN\\n2 :MEMBER\\n3 :GUEST\",\"type\":\"text\"},{\"name\":\"name\",\"value\":\"\",\"desc\":\"name of user\",\"type\":\"text\"},{\"name\":\"age\",\"value\":\"0\",\"desc\":\"age of user\",\"type\":\"text\"},{\"name\":\"sex\",\"value\":\"0\",\"desc\":\"「deprecated」It\\u0027s a secret\",\"type\":\"text\"},{\"name\":\"birthDay\",\"value\":\"\",\"desc\":\"birthDay of user\",\"type\":\"text\"},{\"name\":\"regtime\",\"value\":\"\",\"desc\":\"注册时间\",\"type\":\"text\"}]",
            request4.formParams.toJson()
        )

        val api5 = GsonExUtils.fromJson<HashMap<String, Any?>>(
            "{\"protocolProfileBehavior\":{\"disableBodyPruning\":true},\"request\":{\"method\":\"POST\",\"header\":[{\"type\":\"text\",\"value\":\"multipart/form-data\",\"key\":\"Content-Type\"},{\"description\":\"The authentication Token\",\"type\":\"text\",\"value\":\"\",\"key\":\"token\"}],\"body\":{\"mode\":\"urlencoded\",\"urlencoded\":[{\"description\":\"user id\",\"type\":\"text\",\"value\":\"\",\"key\":\"id\"},{\"description\":\"user type\\n1 :ADMIN\\n2 :MEMBER\\n3 :GUEST\",\"type\":\"text\",\"value\":\"0\",\"key\":\"type\"},{\"description\":\"name of user\",\"type\":\"text\",\"value\":\"\",\"key\":\"name\"}]},\"url\":{\"path\":[\"file\",\"add\"],\"host\":[\"{{user}}\"],\"raw\":\"{{user}}/file/add\"}},\"response\":[{\"originalRequest\":{\"method\":\"POST\",\"header\":[{\"type\":\"text\",\"value\":\"multipart/form-data\",\"key\":\"Content-Type\"},{\"description\":\"The authentication Token\",\"type\":\"text\",\"value\":\"\",\"key\":\"token\"}],\"body\":{\"mode\":\"formdata\",\"formdata\":[{\"src\":[],\"description\":\"profile img of user\",\"type\":\"file\",\"key\":\"profileImg\"},{\"description\":\"user id\",\"type\":\"text\",\"value\":\"0\",\"key\":\"id\"},{\"description\":\"user type\\n1 :ADMIN\\n2 :MEMBER\\n3 :GUEST\",\"type\":\"text\",\"value\":\"0\",\"key\":\"type\"},{\"description\":\"name of user\",\"type\":\"text\",\"value\":\"\",\"key\":\"name\"},{\"description\":\"age of user\",\"type\":\"text\",\"value\":\"0\",\"key\":\"age\"},{\"description\":\"「deprecated」It\\u0027s a secret\",\"type\":\"text\",\"value\":\"0\",\"key\":\"sex\"},{\"description\":\"birthDay of user\",\"type\":\"text\",\"value\":\"\",\"key\":\"birthDay\"},{\"description\":\"注册时间\",\"type\":\"text\",\"value\":\"\",\"key\":\"regtime\"}]},\"url\":{\"path\":[\"file\",\"add\"],\"host\":[\"{{user}}\"],\"raw\":\"{{user}}/file/add\"}},\"_postman_previewlanguage\":\"json\",\"code\":200,\"cookie\":[],\"name\":\"create an user(上传profile img of user)-Example\",\"header\":[{\"name\":\"date\",\"description\":\"The date and time that the message was sent\",\"value\":\"Wed, 25 Aug 202120:46:39 GMT\",\"key\":\"date\"},{\"name\":\"server\",\"description\":\"A name for the server\",\"value\":\"Apache-Coyote/1.1\",\"key\":\"server\"},{\"name\":\"transfer-encoding\",\"description\":\"The form of encoding used to safely transfer the entity to the user. Currently defined methods are: chunked, compress, deflate, gzip, identity.\",\"value\":\"chunked\",\"key\":\"transfer-encoding\"},{\"name\":\"content-type\",\"value\":\"application/json;charset\\u003dUTF-8\",\"key\":\"content-type\"}],\"id\":\"28324d5d-94b9-468d-afee-35abd1f800f5\",\"body\":\"{}\",\"status\":\"OK\"}],\"name\":\"create an user\",\"id\":\"2289716e-d401-4952-9208-7e343aa4b79d\"}"
        )!!
        val request5 = postmanFormatter.item2Request(api5)!!
        assertEquals("create an user", request5.name)
        assertEquals("POST", request5.method)
        assertEquals(URL.of("file/add"), request5.path)
        assertEquals(
            "[{\"name\":\"Content-Type\",\"value\":\"multipart/form-data\"},{\"name\":\"token\",\"value\":\"\",\"desc\":\"The authentication Token\"}]",
            request5.headers.toJson()
        )
        assertNull(request5.querys.toJson())
        assertEquals(
            "[{\"name\":\"id\",\"value\":\"\",\"desc\":\"user id\",\"type\":\"text\"},{\"name\":\"type\",\"value\":\"0\",\"desc\":\"user type\\n1 :ADMIN\\n2 :MEMBER\\n3 :GUEST\",\"type\":\"text\"},{\"name\":\"name\",\"value\":\"\",\"desc\":\"name of user\",\"type\":\"text\"}]",
            request5.formParams.toJson()
        )

    }

    /**
     * use json-schema by default
     */
    fun testParseRequests() {
        settings.postmanJson5FormatType = PostmanJson5FormatType.NONE.name
        val requests = ArrayList<Request>()
        classExporter.export(userCtrlPsiClass, requestOnly {
            requests.add(it)
        })
        (classExporter as Worker).waitCompleted()
        assertEquals(
            "{\"item\":[{\"item\":[{\"request\":{\"method\":\"GET\",\"description\":\"\",\"header\":[{\"key\":\"token\",\"value\":\"\",\"type\":\"text\",\"description\":\"auth token\"}],\"url\":{\"path\":[\"user\",\"get\",\":id\"],\"query\":[{\"key\":\"id\",\"value\":\"0\",\"equals\":true,\"description\":\"user id\"}],\"host\":\"{{test_default}}\",\"raw\":\"{{test_default}}/user/get/{id}\"}},\"response\":[{\"originalRequest\":{\"method\":\"GET\",\"description\":\"\",\"header\":[{\"key\":\"token\",\"value\":\"\",\"type\":\"text\",\"description\":\"auth token\"}],\"url\":{\"path\":[\"user\",\"get\",\":id\"],\"query\":[{\"key\":\"id\",\"value\":\"0\",\"equals\":true,\"description\":\"user id\"}],\"host\":\"{{test_default}}\",\"raw\":\"{{test_default}}/user/get/{id}\"}},\"_postman_previewlanguage\":\"json\",\"code\":200,\"_postman_previewtype\":\"text\",\"responseTime\":50,\"name\":\"get user info-Example\",\"header\":[{\"name\":\"date\",\"key\":\"date\",\"value\":\"$date\",\"description\":\"The date and time that the message was sent\"},{\"name\":\"server\",\"key\":\"server\",\"value\":\"Apache-Coyote/1.1\",\"description\":\"A name for the server\"},{\"name\":\"transfer-encoding\",\"key\":\"transfer-encoding\",\"value\":\"chunked\",\"description\":\"The form of encoding used to safely transfer the entity to the user. Currently defined methods are: chunked, compress, deflate, gzip, identity.\"},{\"name\":\"content-type\",\"key\":\"content-type\",\"value\":\"application/json;charset\\u003dUTF-8\"}],\"body\":\"{\\n  \\\"code\\\": 0,\\n  \\\"msg\\\": \\\"success\\\",\\n  \\\"data\\\": {\\n    \\\"id\\\": 0,\\n    \\\"type\\\": 0,\\n    \\\"name\\\": \\\"Tony Stark\\\",\\n    \\\"age\\\": 45,\\n    \\\"sex\\\": 0,\\n    \\\"birthDay\\\": \\\"\\\",\\n    \\\"regtime\\\": \\\"\\\"\\n  }\\n}\",\"status\":\"OK\"}],\"name\":\"get user info\",\"event\":[{\"listen\":\"prerequest\",\"script\":{\"exec\":[\"pm.environment.set(\\\"token\\\", \\\"123456\\\");\"],\"type\":\"text/javascript\"}},{\"listen\":\"test\",\"script\":{\"exec\":[\"pm.test(\\\"Successful POST request\\\", function () {\",\"pm.expect(pm.response.code).to.be.oneOf([201,202]);\",\"});\"],\"type\":\"text/javascript\"}}]}],\"name\":\"update-apis\",\"description\":\"\"},{\"item\":[{\"request\":{\"method\":\"GET\",\"description\":\"not update anything\",\"header\":[],\"url\":{\"path\":[\"user\",\"greeting\"],\"query\":[],\"host\":\"{{test_default}}\",\"raw\":\"{{test_default}}/user/greeting\"}},\"response\":[{\"originalRequest\":{\"method\":\"GET\",\"description\":\"not update anything\",\"header\":[],\"url\":{\"path\":[\"user\",\"greeting\"],\"query\":[],\"host\":\"{{test_default}}\",\"raw\":\"{{test_default}}/user/greeting\"}},\"_postman_previewlanguage\":\"json\",\"code\":200,\"_postman_previewtype\":\"text\",\"responseTime\":50,\"name\":\"say hello-Example\",\"header\":[{\"name\":\"date\",\"key\":\"date\",\"value\":\"$date\",\"description\":\"The date and time that the message was sent\"},{\"name\":\"server\",\"key\":\"server\",\"value\":\"Apache-Coyote/1.1\",\"description\":\"A name for the server\"},{\"name\":\"transfer-encoding\",\"key\":\"transfer-encoding\",\"value\":\"chunked\",\"description\":\"The form of encoding used to safely transfer the entity to the user. Currently defined methods are: chunked, compress, deflate, gzip, identity.\"},{\"name\":\"content-type\",\"key\":\"content-type\",\"value\":\"application/json;charset\\u003dUTF-8\"}],\"body\":\"\",\"status\":\"OK\"}],\"name\":\"say hello\",\"event\":[{\"listen\":\"prerequest\",\"script\":{\"exec\":[\"pm.environment.set(\\\"token\\\", \\\"123456\\\");\"],\"type\":\"text/javascript\"}},{\"listen\":\"test\",\"script\":{\"exec\":[\"pm.test(\\\"Successful POST request\\\", function () {\",\"pm.expect(pm.response.code).to.be.oneOf([201,202]);\",\"});\"],\"type\":\"text/javascript\"}}]},{\"request\":{\"method\":\"POST\",\"description\":\"\",\"header\":[{\"key\":\"Content-Type\",\"value\":\"application/json\",\"type\":\"text\",\"description\":\"\"},{\"key\":\"token\",\"value\":\"\",\"type\":\"text\",\"description\":\"auth token\"}],\"body\":{\"mode\":\"raw\",\"options\":{\"raw\":{\"language\":\"json\"}},\"raw\":\"{\\n  \\\"id\\\": 0,\\n  \\\"type\\\": 0,\\n  \\\"name\\\": \\\"\\\",\\n  \\\"age\\\": 0,\\n  \\\"sex\\\": 0,\\n  \\\"birthDay\\\": \\\"\\\",\\n  \\\"regtime\\\": \\\"\\\"\\n}\"},\"url\":{\"path\":[\"user\",\"add\"],\"query\":[],\"host\":\"{{test_default}}\",\"raw\":\"{{test_default}}/user/add\"}},\"response\":[{\"originalRequest\":{\"method\":\"POST\",\"description\":\"\",\"header\":[{\"key\":\"Content-Type\",\"value\":\"application/json\",\"type\":\"text\",\"description\":\"\"},{\"key\":\"token\",\"value\":\"\",\"type\":\"text\",\"description\":\"auth token\"}],\"body\":{\"mode\":\"raw\",\"options\":{\"raw\":{\"language\":\"json\"}},\"raw\":\"{\\n  \\\"id\\\": 0,\\n  \\\"type\\\": 0,\\n  \\\"name\\\": \\\"\\\",\\n  \\\"age\\\": 0,\\n  \\\"sex\\\": 0,\\n  \\\"birthDay\\\": \\\"\\\",\\n  \\\"regtime\\\": \\\"\\\"\\n}\"},\"url\":{\"query\":[],\"host\":\"{{test_default}}\"}},\"_postman_previewlanguage\":\"json\",\"code\":200,\"_postman_previewtype\":\"text\",\"responseTime\":50,\"name\":\"create an user-Example\",\"header\":[{\"name\":\"date\",\"key\":\"date\",\"value\":\"$date\",\"description\":\"The date and time that the message was sent\"},{\"name\":\"server\",\"key\":\"server\",\"value\":\"Apache-Coyote/1.1\",\"description\":\"A name for the server\"},{\"name\":\"transfer-encoding\",\"key\":\"transfer-encoding\",\"value\":\"chunked\",\"description\":\"The form of encoding used to safely transfer the entity to the user. Currently defined methods are: chunked, compress, deflate, gzip, identity.\"},{\"name\":\"content-type\",\"key\":\"content-type\",\"value\":\"application/json;charset\\u003dUTF-8\"}],\"body\":\"{\\n  \\\"code\\\": 0,\\n  \\\"msg\\\": \\\"\\\",\\n  \\\"data\\\": {\\n    \\\"id\\\": 0,\\n    \\\"type\\\": 0,\\n    \\\"name\\\": \\\"\\\",\\n    \\\"age\\\": 0,\\n    \\\"sex\\\": 0,\\n    \\\"birthDay\\\": \\\"\\\",\\n    \\\"regtime\\\": \\\"\\\"\\n  }\\n}\",\"status\":\"OK\"}],\"name\":\"create an user\",\"event\":[{\"listen\":\"prerequest\",\"script\":{\"exec\":[\"pm.environment.set(\\\"token\\\", \\\"123456\\\");\"],\"type\":\"text/javascript\"}},{\"listen\":\"test\",\"script\":{\"exec\":[\"pm.test(\\\"Successful POST request\\\", function () {\",\"pm.expect(pm.response.code).to.be.oneOf([201,202]);\",\"});\"],\"type\":\"text/javascript\"}}]},{\"request\":{\"method\":\"PUT\",\"description\":\"\",\"header\":[{\"key\":\"Content-Type\",\"value\":\"multipart/form-data\",\"type\":\"text\",\"description\":\"\"},{\"key\":\"token\",\"value\":\"\",\"type\":\"text\",\"description\":\"auth token\"}],\"body\":{\"mode\":\"formdata\",\"formdata\":[{\"key\":\"id\",\"type\":\"text\",\"description\":\"user id\"},{\"key\":\"type\",\"type\":\"text\",\"description\":\"user type\\n1 :administration\\n2 :a person, an animal or a plant\\n3 :Anonymous visitor\"},{\"key\":\"name\",\"type\":\"text\",\"description\":\"user name\"},{\"key\":\"age\",\"type\":\"text\",\"description\":\"user age\"},{\"key\":\"sex\",\"type\":\"text\",\"description\":\"\"},{\"key\":\"birthDay\",\"type\":\"text\",\"description\":\"user birthDay\"},{\"key\":\"regtime\",\"type\":\"text\",\"description\":\"user regtime\"}]},\"url\":{\"path\":[\"user\",\"update\"],\"query\":[],\"host\":\"{{test_default}}\",\"raw\":\"{{test_default}}/user/update\"}},\"response\":[{\"originalRequest\":{\"method\":\"PUT\",\"description\":\"\",\"header\":[{\"key\":\"Content-Type\",\"value\":\"multipart/form-data\",\"type\":\"text\",\"description\":\"\"},{\"key\":\"token\",\"value\":\"\",\"type\":\"text\",\"description\":\"auth token\"}],\"body\":{\"mode\":\"formdata\",\"formdata\":[{\"key\":\"id\",\"type\":\"text\",\"description\":\"user id\"},{\"key\":\"type\",\"type\":\"text\",\"description\":\"user type\\n1 :administration\\n2 :a person, an animal or a plant\\n3 :Anonymous visitor\"},{\"key\":\"name\",\"type\":\"text\",\"description\":\"user name\"},{\"key\":\"age\",\"type\":\"text\",\"description\":\"user age\"},{\"key\":\"sex\",\"type\":\"text\",\"description\":\"\"},{\"key\":\"birthDay\",\"type\":\"text\",\"description\":\"user birthDay\"},{\"key\":\"regtime\",\"type\":\"text\",\"description\":\"user regtime\"}]},\"url\":{\"path\":[\"user\",\"update\"],\"query\":[],\"host\":\"{{test_default}}\",\"raw\":\"{{test_default}}/user/update\"}},\"_postman_previewlanguage\":\"json\",\"code\":200,\"_postman_previewtype\":\"text\",\"responseTime\":50,\"name\":\"update user info-Example\",\"header\":[{\"name\":\"date\",\"key\":\"date\",\"value\":\"$date\",\"description\":\"The date and time that the message was sent\"},{\"name\":\"server\",\"key\":\"server\",\"value\":\"Apache-Coyote/1.1\",\"description\":\"A name for the server\"},{\"name\":\"transfer-encoding\",\"key\":\"transfer-encoding\",\"value\":\"chunked\",\"description\":\"The form of encoding used to safely transfer the entity to the user. Currently defined methods are: chunked, compress, deflate, gzip, identity.\"},{\"name\":\"content-type\",\"key\":\"content-type\",\"value\":\"application/json;charset\\u003dUTF-8\"}],\"body\":\"{\\n  \\\"code\\\": 0,\\n  \\\"msg\\\": \\\"\\\",\\n  \\\"data\\\": {\\n    \\\"id\\\": 0,\\n    \\\"type\\\": 0,\\n    \\\"name\\\": \\\"\\\",\\n    \\\"age\\\": 0,\\n    \\\"sex\\\": 0,\\n    \\\"birthDay\\\": \\\"\\\",\\n    \\\"regtime\\\": \\\"\\\"\\n  }\\n}\",\"status\":\"OK\"}],\"name\":\"update user info\",\"event\":[{\"listen\":\"prerequest\",\"script\":{\"exec\":[\"pm.environment.set(\\\"token\\\", \\\"123456\\\");\"],\"type\":\"text/javascript\"}},{\"listen\":\"test\",\"script\":{\"exec\":[\"pm.test(\\\"Successful POST request\\\", function () {\",\"pm.expect(pm.response.code).to.be.oneOf([201,202]);\",\"});\"],\"type\":\"text/javascript\"}}]},{\"request\":{\"method\":\"GET\",\"description\":\"\",\"header\":[{\"key\":\"token\",\"value\":\"\",\"type\":\"text\",\"description\":\"auth token\"}],\"url\":{\"path\":[\"user\",\"ctrl\",\"name\"],\"query\":[],\"host\":\"{{test_default}}\",\"raw\":\"{{test_default}}/user/ctrl/name\"}},\"response\":[{\"originalRequest\":{\"method\":\"GET\",\"description\":\"\",\"header\":[{\"key\":\"token\",\"value\":\"\",\"type\":\"text\",\"description\":\"auth token\"}],\"url\":{\"path\":[\"user\",\"ctrl\",\"name\"],\"query\":[],\"host\":\"{{test_default}}\",\"raw\":\"{{test_default}}/user/ctrl/name\"}},\"_postman_previewlanguage\":\"json\",\"code\":200,\"_postman_previewtype\":\"text\",\"responseTime\":50,\"name\":\"current ctrl name-Example\",\"header\":[{\"name\":\"date\",\"key\":\"date\",\"value\":\"$date\",\"description\":\"The date and time that the message was sent\"},{\"name\":\"server\",\"key\":\"server\",\"value\":\"Apache-Coyote/1.1\",\"description\":\"A name for the server\"},{\"name\":\"transfer-encoding\",\"key\":\"transfer-encoding\",\"value\":\"chunked\",\"description\":\"The form of encoding used to safely transfer the entity to the user. Currently defined methods are: chunked, compress, deflate, gzip, identity.\"},{\"name\":\"content-type\",\"key\":\"content-type\",\"value\":\"application/json;charset\\u003dUTF-8\"}],\"body\":\"\",\"status\":\"OK\"}],\"name\":\"current ctrl name\",\"event\":[{\"listen\":\"prerequest\",\"script\":{\"exec\":[\"pm.environment.set(\\\"token\\\", \\\"123456\\\");\"],\"type\":\"text/javascript\"}},{\"listen\":\"test\",\"script\":{\"exec\":[\"pm.test(\\\"Successful POST request\\\", function () {\",\"pm.expect(pm.response.code).to.be.oneOf([201,202]);\",\"});\"],\"type\":\"text/javascript\"}}]}],\"name\":\"apis about user\",\"description\":\"apis about user\\naccess user info\"}],\"info\":{\"schema\":\"https://schema.getpostman.com/json/collection/v2.1.0/collection.json\",\"name\":\"test_default-$LOCAL_TIME_RAW_STRING\",\"description\":\"exported at $LOCAL_TIME_YMS_STRING\"}}",
            postmanFormatter.parseRequests(requests).toJson()
        )
    }

    /**
     * use json-schema by default
     */
    fun testParseRequestsWithWrapCollection() {
        settings.postmanJson5FormatType = PostmanJson5FormatType.ALL.name
        settings.wrapCollection = true
        val requests = ArrayList<Request>()
        classExporter.export(userCtrlPsiClass, requestOnly {
            requests.add(it)
        })
        (classExporter as Worker).waitCompleted()
        assertEquals(
            "{\"item\":[{\"item\":[{\"item\":[{\"request\":{\"method\":\"GET\",\"description\":\"\",\"header\":[{\"key\":\"token\",\"value\":\"\",\"type\":\"text\",\"description\":\"auth token\"}],\"url\":{\"path\":[\"user\",\"get\",\":id\"],\"query\":[{\"key\":\"id\",\"value\":\"0\",\"equals\":true,\"description\":\"user id\"}],\"host\":\"{{test_default}}\",\"raw\":\"{{test_default}}/user/get/{id}\"}},\"response\":[{\"originalRequest\":{\"method\":\"GET\",\"description\":\"\",\"header\":[{\"key\":\"token\",\"value\":\"\",\"type\":\"text\",\"description\":\"auth token\"}],\"url\":{\"path\":[\"user\",\"get\",\":id\"],\"query\":[{\"key\":\"id\",\"value\":\"0\",\"equals\":true,\"description\":\"user id\"}],\"host\":\"{{test_default}}\",\"raw\":\"{{test_default}}/user/get/{id}\"}},\"_postman_previewlanguage\":\"json\",\"code\":200,\"_postman_previewtype\":\"text\",\"responseTime\":50,\"name\":\"get user info-Example\",\"header\":[{\"name\":\"date\",\"key\":\"date\",\"value\":\"$date\",\"description\":\"The date and time that the message was sent\"},{\"name\":\"server\",\"key\":\"server\",\"value\":\"Apache-Coyote/1.1\",\"description\":\"A name for the server\"},{\"name\":\"transfer-encoding\",\"key\":\"transfer-encoding\",\"value\":\"chunked\",\"description\":\"The form of encoding used to safely transfer the entity to the user. Currently defined methods are: chunked, compress, deflate, gzip, identity.\"},{\"name\":\"content-type\",\"key\":\"content-type\",\"value\":\"application/json;charset\\u003dUTF-8\"}],\"body\":\"{\\n    \\\"code\\\": 0, //response code\\n    \\\"msg\\\": \\\"success\\\", //message\\n    \\\"data\\\": { //response data\\n        \\\"id\\\": 0, //user id\\n        /**\\n         * user type\\n         * 1 :administration\\n         * 2 :a person, an animal or a plant\\n         * 3 :Anonymous visitor\\n         */\\n        \\\"type\\\": 0,\\n        \\\"name\\\": \\\"Tony Stark\\\", //user name\\n        \\\"age\\\": 45, //user age\\n        \\\"sex\\\": 0,\\n        \\\"birthDay\\\": \\\"\\\", //user birthDay\\n        \\\"regtime\\\": \\\"\\\" //user regtime\\n    }\\n}\",\"status\":\"OK\"}],\"name\":\"get user info\",\"event\":[{\"listen\":\"prerequest\",\"script\":{\"exec\":[\"pm.environment.set(\\\"token\\\", \\\"123456\\\");\"],\"type\":\"text/javascript\"}},{\"listen\":\"test\",\"script\":{\"exec\":[\"pm.test(\\\"Successful POST request\\\", function () {\",\"pm.expect(pm.response.code).to.be.oneOf([201,202]);\",\"});\"],\"type\":\"text/javascript\"}}]}],\"name\":\"update-apis\",\"description\":\"\"},{\"item\":[{\"request\":{\"method\":\"GET\",\"description\":\"not update anything\",\"header\":[],\"url\":{\"path\":[\"user\",\"greeting\"],\"query\":[],\"host\":\"{{test_default}}\",\"raw\":\"{{test_default}}/user/greeting\"}},\"response\":[{\"originalRequest\":{\"method\":\"GET\",\"description\":\"not update anything\",\"header\":[],\"url\":{\"path\":[\"user\",\"greeting\"],\"query\":[],\"host\":\"{{test_default}}\",\"raw\":\"{{test_default}}/user/greeting\"}},\"_postman_previewlanguage\":\"json\",\"code\":200,\"_postman_previewtype\":\"text\",\"responseTime\":50,\"name\":\"say hello-Example\",\"header\":[{\"name\":\"date\",\"key\":\"date\",\"value\":\"$date\",\"description\":\"The date and time that the message was sent\"},{\"name\":\"server\",\"key\":\"server\",\"value\":\"Apache-Coyote/1.1\",\"description\":\"A name for the server\"},{\"name\":\"transfer-encoding\",\"key\":\"transfer-encoding\",\"value\":\"chunked\",\"description\":\"The form of encoding used to safely transfer the entity to the user. Currently defined methods are: chunked, compress, deflate, gzip, identity.\"},{\"name\":\"content-type\",\"key\":\"content-type\",\"value\":\"application/json;charset\\u003dUTF-8\"}],\"body\":\"\\\"\\\"\",\"status\":\"OK\"}],\"name\":\"say hello\",\"event\":[{\"listen\":\"prerequest\",\"script\":{\"exec\":[\"pm.environment.set(\\\"token\\\", \\\"123456\\\");\"],\"type\":\"text/javascript\"}},{\"listen\":\"test\",\"script\":{\"exec\":[\"pm.test(\\\"Successful POST request\\\", function () {\",\"pm.expect(pm.response.code).to.be.oneOf([201,202]);\",\"});\"],\"type\":\"text/javascript\"}}]},{\"request\":{\"method\":\"POST\",\"description\":\"\",\"header\":[{\"key\":\"Content-Type\",\"value\":\"application/json\",\"type\":\"text\",\"description\":\"\"},{\"key\":\"token\",\"value\":\"\",\"type\":\"text\",\"description\":\"auth token\"}],\"body\":{\"mode\":\"raw\",\"options\":{\"raw\":{\"language\":\"json\"}},\"raw\":\"{\\n    \\\"id\\\": 0, //user id\\n    /**\\n     * user type\\n     * 1 :administration\\n     * 2 :a person, an animal or a plant\\n     * 3 :Anonymous visitor\\n     */\\n    \\\"type\\\": 0,\\n    \\\"name\\\": \\\"\\\", //user name\\n    \\\"age\\\": 0, //user age\\n    \\\"sex\\\": 0,\\n    \\\"birthDay\\\": \\\"\\\", //user birthDay\\n    \\\"regtime\\\": \\\"\\\" //user regtime\\n}\"},\"url\":{\"path\":[\"user\",\"add\"],\"query\":[],\"host\":\"{{test_default}}\",\"raw\":\"{{test_default}}/user/add\"}},\"response\":[{\"originalRequest\":{\"method\":\"POST\",\"description\":\"\",\"header\":[{\"key\":\"Content-Type\",\"value\":\"application/json\",\"type\":\"text\",\"description\":\"\"},{\"key\":\"token\",\"value\":\"\",\"type\":\"text\",\"description\":\"auth token\"}],\"body\":{\"mode\":\"raw\",\"options\":{\"raw\":{\"language\":\"json\"}},\"raw\":\"{\\n    \\\"id\\\": 0, //user id\\n    /**\\n     * user type\\n     * 1 :administration\\n     * 2 :a person, an animal or a plant\\n     * 3 :Anonymous visitor\\n     */\\n    \\\"type\\\": 0,\\n    \\\"name\\\": \\\"\\\", //user name\\n    \\\"age\\\": 0, //user age\\n    \\\"sex\\\": 0,\\n    \\\"birthDay\\\": \\\"\\\", //user birthDay\\n    \\\"regtime\\\": \\\"\\\" //user regtime\\n}\"},\"url\":{\"query\":[],\"host\":\"{{test_default}}\"}},\"_postman_previewlanguage\":\"json\",\"code\":200,\"_postman_previewtype\":\"text\",\"responseTime\":50,\"name\":\"create an user-Example\",\"header\":[{\"name\":\"date\",\"key\":\"date\",\"value\":\"$date\",\"description\":\"The date and time that the message was sent\"},{\"name\":\"server\",\"key\":\"server\",\"value\":\"Apache-Coyote/1.1\",\"description\":\"A name for the server\"},{\"name\":\"transfer-encoding\",\"key\":\"transfer-encoding\",\"value\":\"chunked\",\"description\":\"The form of encoding used to safely transfer the entity to the user. Currently defined methods are: chunked, compress, deflate, gzip, identity.\"},{\"name\":\"content-type\",\"key\":\"content-type\",\"value\":\"application/json;charset\\u003dUTF-8\"}],\"body\":\"{\\n    \\\"code\\\": 0, //response code\\n    \\\"msg\\\": \\\"\\\", //message\\n    \\\"data\\\": { //response data\\n        \\\"id\\\": 0, //user id\\n        /**\\n         * user type\\n         * 1 :administration\\n         * 2 :a person, an animal or a plant\\n         * 3 :Anonymous visitor\\n         */\\n        \\\"type\\\": 0,\\n        \\\"name\\\": \\\"\\\", //user name\\n        \\\"age\\\": 0, //user age\\n        \\\"sex\\\": 0,\\n        \\\"birthDay\\\": \\\"\\\", //user birthDay\\n        \\\"regtime\\\": \\\"\\\" //user regtime\\n    }\\n}\",\"status\":\"OK\"}],\"name\":\"create an user\",\"event\":[{\"listen\":\"prerequest\",\"script\":{\"exec\":[\"pm.environment.set(\\\"token\\\", \\\"123456\\\");\"],\"type\":\"text/javascript\"}},{\"listen\":\"test\",\"script\":{\"exec\":[\"pm.test(\\\"Successful POST request\\\", function () {\",\"pm.expect(pm.response.code).to.be.oneOf([201,202]);\",\"});\"],\"type\":\"text/javascript\"}}]},{\"request\":{\"method\":\"PUT\",\"description\":\"\",\"header\":[{\"key\":\"Content-Type\",\"value\":\"multipart/form-data\",\"type\":\"text\",\"description\":\"\"},{\"key\":\"token\",\"value\":\"\",\"type\":\"text\",\"description\":\"auth token\"}],\"body\":{\"mode\":\"formdata\",\"formdata\":[{\"key\":\"id\",\"type\":\"text\",\"description\":\"user id\"},{\"key\":\"type\",\"type\":\"text\",\"description\":\"user type\\n1 :administration\\n2 :a person, an animal or a plant\\n3 :Anonymous visitor\"},{\"key\":\"name\",\"type\":\"text\",\"description\":\"user name\"},{\"key\":\"age\",\"type\":\"text\",\"description\":\"user age\"},{\"key\":\"sex\",\"type\":\"text\",\"description\":\"\"},{\"key\":\"birthDay\",\"type\":\"text\",\"description\":\"user birthDay\"},{\"key\":\"regtime\",\"type\":\"text\",\"description\":\"user regtime\"}]},\"url\":{\"path\":[\"user\",\"update\"],\"query\":[],\"host\":\"{{test_default}}\",\"raw\":\"{{test_default}}/user/update\"}},\"response\":[{\"originalRequest\":{\"method\":\"PUT\",\"description\":\"\",\"header\":[{\"key\":\"Content-Type\",\"value\":\"multipart/form-data\",\"type\":\"text\",\"description\":\"\"},{\"key\":\"token\",\"value\":\"\",\"type\":\"text\",\"description\":\"auth token\"}],\"body\":{\"mode\":\"formdata\",\"formdata\":[{\"key\":\"id\",\"type\":\"text\",\"description\":\"user id\"},{\"key\":\"type\",\"type\":\"text\",\"description\":\"user type\\n1 :administration\\n2 :a person, an animal or a plant\\n3 :Anonymous visitor\"},{\"key\":\"name\",\"type\":\"text\",\"description\":\"user name\"},{\"key\":\"age\",\"type\":\"text\",\"description\":\"user age\"},{\"key\":\"sex\",\"type\":\"text\",\"description\":\"\"},{\"key\":\"birthDay\",\"type\":\"text\",\"description\":\"user birthDay\"},{\"key\":\"regtime\",\"type\":\"text\",\"description\":\"user regtime\"}]},\"url\":{\"path\":[\"user\",\"update\"],\"query\":[],\"host\":\"{{test_default}}\",\"raw\":\"{{test_default}}/user/update\"}},\"_postman_previewlanguage\":\"json\",\"code\":200,\"_postman_previewtype\":\"text\",\"responseTime\":50,\"name\":\"update user info-Example\",\"header\":[{\"name\":\"date\",\"key\":\"date\",\"value\":\"$date\",\"description\":\"The date and time that the message was sent\"},{\"name\":\"server\",\"key\":\"server\",\"value\":\"Apache-Coyote/1.1\",\"description\":\"A name for the server\"},{\"name\":\"transfer-encoding\",\"key\":\"transfer-encoding\",\"value\":\"chunked\",\"description\":\"The form of encoding used to safely transfer the entity to the user. Currently defined methods are: chunked, compress, deflate, gzip, identity.\"},{\"name\":\"content-type\",\"key\":\"content-type\",\"value\":\"application/json;charset\\u003dUTF-8\"}],\"body\":\"{\\n    \\\"code\\\": 0, //response code\\n    \\\"msg\\\": \\\"\\\", //message\\n    \\\"data\\\": { //response data\\n        \\\"id\\\": 0, //user id\\n        /**\\n         * user type\\n         * 1 :administration\\n         * 2 :a person, an animal or a plant\\n         * 3 :Anonymous visitor\\n         */\\n        \\\"type\\\": 0,\\n        \\\"name\\\": \\\"\\\", //user name\\n        \\\"age\\\": 0, //user age\\n        \\\"sex\\\": 0,\\n        \\\"birthDay\\\": \\\"\\\", //user birthDay\\n        \\\"regtime\\\": \\\"\\\" //user regtime\\n    }\\n}\",\"status\":\"OK\"}],\"name\":\"update user info\",\"event\":[{\"listen\":\"prerequest\",\"script\":{\"exec\":[\"pm.environment.set(\\\"token\\\", \\\"123456\\\");\"],\"type\":\"text/javascript\"}},{\"listen\":\"test\",\"script\":{\"exec\":[\"pm.test(\\\"Successful POST request\\\", function () {\",\"pm.expect(pm.response.code).to.be.oneOf([201,202]);\",\"});\"],\"type\":\"text/javascript\"}}]},{\"request\":{\"method\":\"GET\",\"description\":\"\",\"header\":[{\"key\":\"token\",\"value\":\"\",\"type\":\"text\",\"description\":\"auth token\"}],\"url\":{\"path\":[\"user\",\"ctrl\",\"name\"],\"query\":[],\"host\":\"{{test_default}}\",\"raw\":\"{{test_default}}/user/ctrl/name\"}},\"response\":[{\"originalRequest\":{\"method\":\"GET\",\"description\":\"\",\"header\":[{\"key\":\"token\",\"value\":\"\",\"type\":\"text\",\"description\":\"auth token\"}],\"url\":{\"path\":[\"user\",\"ctrl\",\"name\"],\"query\":[],\"host\":\"{{test_default}}\",\"raw\":\"{{test_default}}/user/ctrl/name\"}},\"_postman_previewlanguage\":\"json\",\"code\":200,\"_postman_previewtype\":\"text\",\"responseTime\":50,\"name\":\"current ctrl name-Example\",\"header\":[{\"name\":\"date\",\"key\":\"date\",\"value\":\"$date\",\"description\":\"The date and time that the message was sent\"},{\"name\":\"server\",\"key\":\"server\",\"value\":\"Apache-Coyote/1.1\",\"description\":\"A name for the server\"},{\"name\":\"transfer-encoding\",\"key\":\"transfer-encoding\",\"value\":\"chunked\",\"description\":\"The form of encoding used to safely transfer the entity to the user. Currently defined methods are: chunked, compress, deflate, gzip, identity.\"},{\"name\":\"content-type\",\"key\":\"content-type\",\"value\":\"application/json;charset\\u003dUTF-8\"}],\"body\":\"\\\"\\\"\",\"status\":\"OK\"}],\"name\":\"current ctrl name\",\"event\":[{\"listen\":\"prerequest\",\"script\":{\"exec\":[\"pm.environment.set(\\\"token\\\", \\\"123456\\\");\"],\"type\":\"text/javascript\"}},{\"listen\":\"test\",\"script\":{\"exec\":[\"pm.test(\\\"Successful POST request\\\", function () {\",\"pm.expect(pm.response.code).to.be.oneOf([201,202]);\",\"});\"],\"type\":\"text/javascript\"}}]}],\"name\":\"apis about user\",\"description\":\"apis about user\\naccess user info\"}],\"name\":\"test_default\",\"description\":\"exported at $LOCAL_TIME_YMS_STRING\"}],\"info\":{\"schema\":\"https://schema.getpostman.com/json/collection/v2.1.0/collection.json\",\"name\":\"test_default-$LOCAL_TIME_RAW_STRING\",\"description\":\"exported at $LOCAL_TIME_YMS_STRING\"}}",
            postmanFormatter.parseRequests(requests).toJson()
        )
    }

    /**
     * use json-schema by default
     */
    fun testParseRequestsToCollection() {
        settings.postmanJson5FormatType = PostmanJson5FormatType.NONE.name
        val requests = ArrayList<Request>()
        classExporter.export(userCtrlPsiClass, requestOnly {
            requests.add(it)
        })
        (classExporter as Worker).waitCompleted()
        val collectionInfo = GsonExUtils.fromJson<HashMap<String, Any?>>(
            "{\"item\":[{\"item\":[{\"request\":{\"method\":\"GET\",\"description\":\"not update anything\",\"header\":[],\"url\":{\"path\":[\"user\",\"greeting\"],\"query\":[],\"host\":\"{{test_default}}\",\"raw\":\"{{test_default}}/user/greeting\"}},\"response\":[{\"originalRequest\":{\"method\":\"GET\",\"description\":\"not update anything\",\"header\":[],\"url\":{\"path\":[\"user\",\"greeting\"],\"query\":[],\"host\":\"{{test_default}}\",\"raw\":\"{{test_default}}/user/greeting\"}},\"_postman_previewlanguage\":\"json\",\"code\":200,\"_postman_previewtype\":\"text\",\"responseTime\":50,\"name\":\"say hello-Example\",\"header\":[{\"name\":\"date\",\"key\":\"date\",\"value\":\"$date\",\"description\":\"The date and time that the message was sent\"},{\"name\":\"server\",\"key\":\"server\",\"value\":\"Apache-Coyote/1.1\",\"description\":\"A name for the server\"},{\"name\":\"transfer-encoding\",\"key\":\"transfer-encoding\",\"value\":\"chunked\",\"description\":\"The form of encoding used to safely transfer the entity to the user. Currently defined methods are: chunked, compress, deflate, gzip, identity.\"},{\"name\":\"content-type\",\"key\":\"content-type\",\"value\":\"application/json;charset=UTF-8\"}],\"body\":\"\\\"\\\"\",\"status\":\"OK\"}],\"name\":\"say hello, hello!\",\"event\":[{\"listen\":\"prerequest\",\"script\":{\"exec\":[\"pm.environment.set(\\\"token\\\", \\\"123456\\\");\"],\"type\":\"text/javascript\"}},{\"listen\":\"test\",\"script\":{\"exec\":[\"pm.test(\\\"Successful POST request\\\", function () {\",\"pm.expect(pm.response.code).to.be.oneOf([201,202]);\",\"});\"],\"type\":\"text/javascript\"}}]},{\"request\":{\"method\":\"GET\",\"description\":\"\",\"header\":[{\"key\":\"token\",\"value\":\"\",\"type\":\"text\",\"description\":\"auth token\"}],\"url\":{\"path\":[\"user\",\"get\",\":id\"],\"query\":[{\"key\":\"id\",\"value\":\"0\",\"equals\":true,\"description\":\"user id\"}],\"host\":\"{{test_default}}\",\"raw\":\"{{test_default}}/user/get/{id}\"}},\"response\":[{\"originalRequest\":{\"method\":\"GET\",\"description\":\"\",\"header\":[{\"key\":\"token\",\"value\":\"\",\"type\":\"text\",\"description\":\"auth token\"}],\"url\":{\"path\":[\"user\",\"get\",\":id\"],\"query\":[{\"key\":\"id\",\"value\":\"0\",\"equals\":true,\"description\":\"user id\"}],\"host\":\"{{test_default}}\",\"raw\":\"{{test_default}}/user/get/{id}\"}},\"_postman_previewlanguage\":\"json\",\"code\":200,\"_postman_previewtype\":\"text\",\"responseTime\":50,\"name\":\"get user info-Example\",\"header\":[{\"name\":\"date\",\"key\":\"date\",\"value\":\"$date\",\"description\":\"The date and time that the message was sent\"},{\"name\":\"server\",\"key\":\"server\",\"value\":\"Apache-Coyote/1.1\",\"description\":\"A name for the server\"},{\"name\":\"transfer-encoding\",\"key\":\"transfer-encoding\",\"value\":\"chunked\",\"description\":\"The form of encoding used to safely transfer the entity to the user. Currently defined methods are: chunked, compress, deflate, gzip, identity.\"},{\"name\":\"content-type\",\"key\":\"content-type\",\"value\":\"application/json;charset=UTF-8\"}],\"body\":\"{\\n    \\\"code\\\": 0, //response code\\n    \\\"msg\\\": \\\"success\\\", //message\\n    \\\"data\\\": { //response data\\n        \\\"id\\\": 0, //user id\\n        /**\\n         * user type\\n         * 1 :administration\\n         * 2 :a person, an animal or a plant\\n         * 3 :Anonymous visitor\\n         */\\n        \\\"type\\\": 0,\\n        \\\"name\\\": \\\"Tony Stark\\\", //user name\\n        \\\"age\\\": 45, //user age\\n        \\\"sex\\\": 0,\\n        \\\"birthDay\\\": \\\"\\\", //user birthDay\\n        \\\"regtime\\\": \\\"\\\" //user regtime\\n    }\\n}\",\"status\":\"OK\"}],\"name\":\"get user info\",\"event\":[{\"listen\":\"prerequest\",\"script\":{\"exec\":[\"pm.environment.set(\\\"token\\\", \\\"123456\\\");\"],\"type\":\"text/javascript\"}},{\"listen\":\"test\",\"script\":{\"exec\":[\"pm.test(\\\"Successful POST request\\\", function () {\",\"pm.expect(pm.response.code).to.be.oneOf([201,202]);\",\"});\"],\"type\":\"text/javascript\"}}]},{\"request\":{\"method\":\"POST\",\"description\":\"create a new user\",\"header\":[{\"key\":\"Content-Type\",\"value\":\"application/json\",\"type\":\"text\",\"description\":\"\"},{\"key\":\"token\",\"value\":\"\",\"type\":\"text\",\"description\":\"auth token\"}],\"body\":{\"mode\":\"raw\",\"options\":{\"raw\":{\"language\":\"json\"}},\"raw\":\"{\\n    \\\"id\\\": 0, //user id\\n    /**\\n     * user type\\n     * 1 :administration\\n     * 2 :a person, an animal or a plant\\n     * 3 :Anonymous visitor\\n     */\\n    \\\"type\\\": 0,\\n    \\\"name\\\": \\\"\\\", //user name\\n    \\\"age\\\": 0, //user age\\n    \\\"sex\\\": 0,\\n    \\\"birthDay\\\": \\\"\\\", //user birthDay\\n    \\\"regtime\\\": \\\"\\\" //user regtime\\n}\"},\"url\":{\"path\":[\"user\",\"create\"],\"query\":[{\"key\":\"id\",\"value\":\"0\",\"equals\":true,\"description\":\"user id\"}],\"host\":\"{{test_default}}\",\"raw\":\"{{test_default}}/user/add\"}},\"response\":[{\"originalRequest\":{\"method\":\"POST\",\"description\":\"\",\"header\":[{\"key\":\"Content-Type\",\"value\":\"application/json\",\"type\":\"text\",\"description\":\"\"},{\"key\":\"token\",\"value\":\"\",\"type\":\"text\",\"description\":\"auth token\"}],\"body\":{\"mode\":\"raw\",\"options\":{\"raw\":{\"language\":\"json\"}},\"raw\":\"{\\n    \\\"id\\\": 0, //user id\\n    /**\\n     * user type\\n     * 1 :administration\\n     * 2 :a person, an animal or a plant\\n     * 3 :Anonymous visitor\\n     */\\n    \\\"type\\\": 0,\\n    \\\"name\\\": \\\"\\\", //user name\\n    \\\"age\\\": 0, //user age\\n    \\\"sex\\\": 0,\\n    \\\"birthDay\\\": \\\"\\\", //user birthDay\\n    \\\"regtime\\\": \\\"\\\" //user regtime\\n}\"},\"url\":{\"query\":[],\"host\":\"{{test_default}}\"}},\"_postman_previewlanguage\":\"json\",\"code\":200,\"_postman_previewtype\":\"text\",\"responseTime\":50,\"name\":\"create an user-Example\",\"header\":[{\"name\":\"date\",\"key\":\"date\",\"value\":\"$date\",\"description\":\"The date and time that the message was sent\"},{\"name\":\"server\",\"key\":\"server\",\"value\":\"Apache-Coyote/1.1\",\"description\":\"A name for the server\"},{\"name\":\"transfer-encoding\",\"key\":\"transfer-encoding\",\"value\":\"chunked\",\"description\":\"The form of encoding used to safely transfer the entity to the user. Currently defined methods are: chunked, compress, deflate, gzip, identity.\"},{\"name\":\"content-type\",\"key\":\"content-type\",\"value\":\"application/json;charset=UTF-8\"}],\"body\":\"{\\n    \\\"code\\\": 0, //response code\\n    \\\"msg\\\": \\\"\\\", //message\\n    \\\"data\\\": { //response data\\n        \\\"id\\\": 0, //user id\\n        /**\\n         * user type\\n         * 1 :administration\\n         * 2 :a person, an animal or a plant\\n         * 3 :Anonymous visitor\\n         */\\n        \\\"type\\\": 0,\\n        \\\"name\\\": \\\"\\\", //user name\\n        \\\"age\\\": 0, //user age\\n        \\\"sex\\\": 0,\\n        \\\"birthDay\\\": \\\"\\\", //user birthDay\\n        \\\"regtime\\\": \\\"\\\" //user regtime\\n    }\\n}\",\"status\":\"OK\"}],\"name\":\"create an user\",\"event\":[{\"listen\":\"prerequest\",\"script\":{\"exec\":[\"pm.environment.set(\\\"token\\\", \\\"123456\\\");\"],\"type\":\"text/javascript\"}},{\"listen\":\"test\",\"script\":{\"exec\":[\"pm.test(\\\"Successful POST request\\\", function () {\",\"pm.expect(pm.response.code).to.be.oneOf([201,202]);\",\"});\"],\"type\":\"text/javascript\"}}]},{\"request\":{\"method\":\"POST\",\"description\":\"\",\"header\":[{\"key\":\"Content-Type\",\"value\":\"multipart/form-data\",\"type\":\"text\",\"description\":\"\"},{\"key\":\"token\",\"value\":\"\",\"type\":\"text\",\"description\":\"auth token\"}],\"body\":{\"mode\":\"formdata\",\"formdata\":[{\"key\":\"id\",\"type\":\"text\",\"description\":\"user id\"},{\"key\":\"type\",\"type\":\"text\",\"description\":\"user type\\n1 :administration\\n2 :a person, an animal or a plant\\n3 :Anonymous visitor\"},{\"key\":\"name\",\"type\":\"text\",\"description\":\"user name\"},{\"key\":\"age\",\"type\":\"text\",\"description\":\"user age\"},{\"key\":\"sex\",\"type\":\"text\",\"description\":\"\"},{\"key\":\"birthDay\",\"type\":\"text\",\"description\":\"user birthDay\"},{\"key\":\"regtime\",\"type\":\"text\",\"description\":\"user regtime\"}]},\"url\":{\"path\":[\"user\",\"update\"],\"query\":[],\"host\":\"{{test_default}}\",\"raw\":\"{{test_default}}/user/update\"}},\"response\":[{\"originalRequest\":{\"method\":\"PUT\",\"description\":\"\",\"header\":[{\"key\":\"Content-Type\",\"value\":\"multipart/form-data\",\"type\":\"text\",\"description\":\"\"},{\"key\":\"token\",\"value\":\"\",\"type\":\"text\",\"description\":\"auth token\"}],\"body\":{\"mode\":\"formdata\",\"formdata\":[{\"key\":\"id\",\"type\":\"text\",\"description\":\"user id\"},{\"key\":\"type\",\"type\":\"text\",\"description\":\"user type\\n1 :administration\\n2 :a person, an animal or a plant\\n3 :Anonymous visitor\"},{\"key\":\"name\",\"type\":\"text\",\"description\":\"user name\"},{\"key\":\"age\",\"type\":\"text\",\"description\":\"user age\"},{\"key\":\"sex\",\"type\":\"text\",\"description\":\"\"},{\"key\":\"birthDay\",\"type\":\"text\",\"description\":\"user birthDay\"},{\"key\":\"regtime\",\"type\":\"text\",\"description\":\"user regtime\"}]},\"url\":{\"path\":[\"user\",\"update\"],\"query\":[],\"host\":\"{{test_default}}\",\"raw\":\"{{test_default}}/user/update\"}},\"_postman_previewlanguage\":\"json\",\"code\":200,\"_postman_previewtype\":\"text\",\"responseTime\":50,\"name\":\"update user info-Example\",\"header\":[{\"name\":\"date\",\"key\":\"date\",\"value\":\"$date\",\"description\":\"The date and time that the message was sent\"},{\"name\":\"server\",\"key\":\"server\",\"value\":\"Apache-Coyote/1.1\",\"description\":\"A name for the server\"},{\"name\":\"transfer-encoding\",\"key\":\"transfer-encoding\",\"value\":\"chunked\",\"description\":\"The form of encoding used to safely transfer the entity to the user. Currently defined methods are: chunked, compress, deflate, gzip, identity.\"},{\"name\":\"content-type\",\"key\":\"content-type\",\"value\":\"application/json;charset=UTF-8\"}],\"body\":\"{\\n    \\\"code\\\": 0, //response code\\n    \\\"msg\\\": \\\"\\\", //message\\n    \\\"data\\\": { //response data\\n        \\\"id\\\": 0, //user id\\n        /**\\n         * user type\\n         * 1 :administration\\n         * 2 :a person, an animal or a plant\\n         * 3 :Anonymous visitor\\n         */\\n        \\\"type\\\": 0,\\n        \\\"name\\\": \\\"\\\", //user name\\n        \\\"age\\\": 0, //user age\\n        \\\"sex\\\": 0,\\n        \\\"birthDay\\\": \\\"\\\", //user birthDay\\n        \\\"regtime\\\": \\\"\\\" //user regtime\\n    }\\n}\",\"status\":\"OK\"}],\"name\":\"update user info\",\"event\":[{\"listen\":\"prerequest\",\"script\":{\"exec\":[\"pm.environment.set(\\\"token\\\", \\\"123456\\\");\"],\"type\":\"text/javascript\"}},{\"listen\":\"test\",\"script\":{\"exec\":[\"pm.test(\\\"Successful POST request\\\", function () {\",\"pm.expect(pm.response.code).to.be.oneOf([201,202]);\",\"});\"],\"type\":\"text/javascript\"}}]}],\"name\":\"apis about user\",\"description\":\"apis about user\\naccess user info\"}],\"info\":{\"schema\":\"https://schema.getpostman.com/json/collection/v2.1.0/collection.json\",\"name\":\"test_default-$LOCAL_TIME_RAW_STRING\",\"description\":\"exported at $LOCAL_TIME_YMS_STRING\"}}"
        )!!
        postmanFormatter.parseRequestsToCollection(collectionInfo, requests)
        assertEquals(
            "{\"item\":[{\"item\":[{\"request\":{\"method\":\"GET\",\"description\":\"not update anything\",\"header\":[],\"url\":{\"path\":[\"user\",\"greeting\"],\"query\":[],\"host\":\"{{test_default}}\",\"raw\":\"{{test_default}}/user/greeting\"}},\"response\":[{\"originalRequest\":{\"method\":\"GET\",\"description\":\"not update anything\",\"header\":[],\"url\":{\"path\":[\"user\",\"greeting\"],\"query\":[],\"host\":\"{{test_default}}\",\"raw\":\"{{test_default}}/user/greeting\"}},\"_postman_previewlanguage\":\"json\",\"code\":200,\"_postman_previewtype\":\"text\",\"responseTime\":50,\"name\":\"say hello-Example\",\"header\":[{\"name\":\"date\",\"key\":\"date\",\"value\":\"$date\",\"description\":\"The date and time that the message was sent\"},{\"name\":\"server\",\"key\":\"server\",\"value\":\"Apache-Coyote/1.1\",\"description\":\"A name for the server\"},{\"name\":\"transfer-encoding\",\"key\":\"transfer-encoding\",\"value\":\"chunked\",\"description\":\"The form of encoding used to safely transfer the entity to the user. Currently defined methods are: chunked, compress, deflate, gzip, identity.\"},{\"name\":\"content-type\",\"key\":\"content-type\",\"value\":\"application/json;charset\\u003dUTF-8\"}],\"body\":\"\",\"status\":\"OK\"}],\"name\":\"say hello\",\"event\":[{\"listen\":\"prerequest\",\"script\":{\"exec\":[\"pm.environment.set(\\\"token\\\", \\\"123456\\\");\"],\"type\":\"text/javascript\"}},{\"listen\":\"test\",\"script\":{\"exec\":[\"pm.test(\\\"Successful POST request\\\", function () {\",\"pm.expect(pm.response.code).to.be.oneOf([201,202]);\",\"});\"],\"type\":\"text/javascript\"}}]},{\"request\":{\"method\":\"GET\",\"description\":\"\",\"header\":[{\"description\":\"auth token\",\"type\":\"text\",\"value\":\"\",\"key\":\"token\"}],\"url\":{\"path\":[\"user\",\"get\",\":id\"],\"query\":[{\"equals\":true,\"description\":\"user id\",\"value\":\"0\",\"key\":\"id\"}],\"host\":\"{{test_default}}\",\"raw\":\"{{test_default}}/user/get/{id}\"}},\"response\":[{\"originalRequest\":{\"method\":\"GET\",\"description\":\"\",\"header\":[{\"description\":\"auth token\",\"type\":\"text\",\"value\":\"\",\"key\":\"token\"}],\"url\":{\"path\":[\"user\",\"get\",\":id\"],\"query\":[{\"equals\":true,\"description\":\"user id\",\"value\":\"0\",\"key\":\"id\"}],\"host\":\"{{test_default}}\",\"raw\":\"{{test_default}}/user/get/{id}\"}},\"_postman_previewlanguage\":\"json\",\"code\":200,\"_postman_previewtype\":\"text\",\"responseTime\":50,\"name\":\"get user info-Example\",\"header\":[{\"name\":\"date\",\"description\":\"The date and time that the message was sent\",\"value\":\"$date\",\"key\":\"date\"},{\"name\":\"server\",\"description\":\"A name for the server\",\"value\":\"Apache-Coyote/1.1\",\"key\":\"server\"},{\"name\":\"transfer-encoding\",\"description\":\"The form of encoding used to safely transfer the entity to the user. Currently defined methods are: chunked, compress, deflate, gzip, identity.\",\"value\":\"chunked\",\"key\":\"transfer-encoding\"},{\"name\":\"content-type\",\"value\":\"application/json;charset\\u003dUTF-8\",\"key\":\"content-type\"}],\"body\":\"{\\n    \\\"code\\\": 0, //response code\\n    \\\"msg\\\": \\\"success\\\", //message\\n    \\\"data\\\": { //response data\\n        \\\"id\\\": 0, //user id\\n        /**\\n         * user type\\n         * 1 :administration\\n         * 2 :a person, an animal or a plant\\n         * 3 :Anonymous visitor\\n         */\\n        \\\"type\\\": 0,\\n        \\\"name\\\": \\\"Tony Stark\\\", //user name\\n        \\\"age\\\": 45, //user age\\n        \\\"sex\\\": 0,\\n        \\\"birthDay\\\": \\\"\\\", //user birthDay\\n        \\\"regtime\\\": \\\"\\\" //user regtime\\n    }\\n}\",\"status\":\"OK\"}],\"name\":\"get user info\",\"event\":[{\"listen\":\"prerequest\",\"script\":{\"type\":\"text/javascript\",\"exec\":[\"pm.environment.set(\\\"token\\\", \\\"123456\\\");\"]}},{\"listen\":\"test\",\"script\":{\"type\":\"text/javascript\",\"exec\":[\"pm.test(\\\"Successful POST request\\\", function () {\",\"pm.expect(pm.response.code).to.be.oneOf([201,202]);\",\"});\"]}}]},{\"request\":{\"method\":\"POST\",\"description\":\"create a new user\",\"header\":[{\"description\":\"\",\"type\":\"text\",\"value\":\"application/json\",\"key\":\"Content-Type\"},{\"description\":\"auth token\",\"type\":\"text\",\"value\":\"\",\"key\":\"token\"}],\"body\":{\"mode\":\"raw\",\"options\":{\"raw\":{\"language\":\"json\"}},\"raw\":\"{\\n    \\\"id\\\": 0, //user id\\n    /**\\n     * user type\\n     * 1 :administration\\n     * 2 :a person, an animal or a plant\\n     * 3 :Anonymous visitor\\n     */\\n    \\\"type\\\": 0,\\n    \\\"name\\\": \\\"\\\", //user name\\n    \\\"age\\\": 0, //user age\\n    \\\"sex\\\": 0,\\n    \\\"birthDay\\\": \\\"\\\", //user birthDay\\n    \\\"regtime\\\": \\\"\\\" //user regtime\\n}\"},\"url\":{\"path\":[\"user\",\"create\"],\"query\":[{\"equals\":true,\"description\":\"user id\",\"value\":\"0\",\"key\":\"id\"}],\"host\":\"{{test_default}}\",\"raw\":\"{{test_default}}/user/add\"}},\"response\":[{\"originalRequest\":{\"method\":\"POST\",\"description\":\"\",\"header\":[{\"description\":\"\",\"type\":\"text\",\"value\":\"application/json\",\"key\":\"Content-Type\"},{\"description\":\"auth token\",\"type\":\"text\",\"value\":\"\",\"key\":\"token\"}],\"body\":{\"mode\":\"raw\",\"options\":{\"raw\":{\"language\":\"json\"}},\"raw\":\"{\\n    \\\"id\\\": 0, //user id\\n    /**\\n     * user type\\n     * 1 :administration\\n     * 2 :a person, an animal or a plant\\n     * 3 :Anonymous visitor\\n     */\\n    \\\"type\\\": 0,\\n    \\\"name\\\": \\\"\\\", //user name\\n    \\\"age\\\": 0, //user age\\n    \\\"sex\\\": 0,\\n    \\\"birthDay\\\": \\\"\\\", //user birthDay\\n    \\\"regtime\\\": \\\"\\\" //user regtime\\n}\"},\"url\":{\"query\":[],\"host\":\"{{test_default}}\"}},\"_postman_previewlanguage\":\"json\",\"code\":200,\"_postman_previewtype\":\"text\",\"responseTime\":50,\"name\":\"create an user-Example\",\"header\":[{\"name\":\"date\",\"description\":\"The date and time that the message was sent\",\"value\":\"$date\",\"key\":\"date\"},{\"name\":\"server\",\"description\":\"A name for the server\",\"value\":\"Apache-Coyote/1.1\",\"key\":\"server\"},{\"name\":\"transfer-encoding\",\"description\":\"The form of encoding used to safely transfer the entity to the user. Currently defined methods are: chunked, compress, deflate, gzip, identity.\",\"value\":\"chunked\",\"key\":\"transfer-encoding\"},{\"name\":\"content-type\",\"value\":\"application/json;charset\\u003dUTF-8\",\"key\":\"content-type\"}],\"body\":\"{\\n    \\\"code\\\": 0, //response code\\n    \\\"msg\\\": \\\"\\\", //message\\n    \\\"data\\\": { //response data\\n        \\\"id\\\": 0, //user id\\n        /**\\n         * user type\\n         * 1 :administration\\n         * 2 :a person, an animal or a plant\\n         * 3 :Anonymous visitor\\n         */\\n        \\\"type\\\": 0,\\n        \\\"name\\\": \\\"\\\", //user name\\n        \\\"age\\\": 0, //user age\\n        \\\"sex\\\": 0,\\n        \\\"birthDay\\\": \\\"\\\", //user birthDay\\n        \\\"regtime\\\": \\\"\\\" //user regtime\\n    }\\n}\",\"status\":\"OK\"}],\"name\":\"create an user\",\"event\":[{\"listen\":\"prerequest\",\"script\":{\"type\":\"text/javascript\",\"exec\":[\"pm.environment.set(\\\"token\\\", \\\"123456\\\");\"]}},{\"listen\":\"test\",\"script\":{\"type\":\"text/javascript\",\"exec\":[\"pm.test(\\\"Successful POST request\\\", function () {\",\"pm.expect(pm.response.code).to.be.oneOf([201,202]);\",\"});\"]}}]},{\"request\":{\"method\":\"POST\",\"description\":\"\",\"header\":[{\"description\":\"\",\"type\":\"text\",\"value\":\"multipart/form-data\",\"key\":\"Content-Type\"},{\"description\":\"auth token\",\"type\":\"text\",\"value\":\"\",\"key\":\"token\"}],\"body\":{\"mode\":\"formdata\",\"formdata\":[{\"description\":\"user id\",\"type\":\"text\",\"key\":\"id\"},{\"description\":\"user type\\n1 :administration\\n2 :a person, an animal or a plant\\n3 :Anonymous visitor\",\"type\":\"text\",\"key\":\"type\"},{\"description\":\"user name\",\"type\":\"text\",\"key\":\"name\"},{\"description\":\"user age\",\"type\":\"text\",\"key\":\"age\"},{\"description\":\"\",\"type\":\"text\",\"key\":\"sex\"},{\"description\":\"user birthDay\",\"type\":\"text\",\"key\":\"birthDay\"},{\"description\":\"user regtime\",\"type\":\"text\",\"key\":\"regtime\"}]},\"url\":{\"path\":[\"user\",\"update\"],\"query\":[],\"host\":\"{{test_default}}\",\"raw\":\"{{test_default}}/user/update\"}},\"response\":[{\"originalRequest\":{\"method\":\"PUT\",\"description\":\"\",\"header\":[{\"description\":\"\",\"type\":\"text\",\"value\":\"multipart/form-data\",\"key\":\"Content-Type\"},{\"description\":\"auth token\",\"type\":\"text\",\"value\":\"\",\"key\":\"token\"}],\"body\":{\"mode\":\"formdata\",\"formdata\":[{\"description\":\"user id\",\"type\":\"text\",\"key\":\"id\"},{\"description\":\"user type\\n1 :administration\\n2 :a person, an animal or a plant\\n3 :Anonymous visitor\",\"type\":\"text\",\"key\":\"type\"},{\"description\":\"user name\",\"type\":\"text\",\"key\":\"name\"},{\"description\":\"user age\",\"type\":\"text\",\"key\":\"age\"},{\"description\":\"\",\"type\":\"text\",\"key\":\"sex\"},{\"description\":\"user birthDay\",\"type\":\"text\",\"key\":\"birthDay\"},{\"description\":\"user regtime\",\"type\":\"text\",\"key\":\"regtime\"}]},\"url\":{\"path\":[\"user\",\"update\"],\"query\":[],\"host\":\"{{test_default}}\",\"raw\":\"{{test_default}}/user/update\"}},\"_postman_previewlanguage\":\"json\",\"code\":200,\"_postman_previewtype\":\"text\",\"responseTime\":50,\"name\":\"update user info-Example\",\"header\":[{\"name\":\"date\",\"description\":\"The date and time that the message was sent\",\"value\":\"$date\",\"key\":\"date\"},{\"name\":\"server\",\"description\":\"A name for the server\",\"value\":\"Apache-Coyote/1.1\",\"key\":\"server\"},{\"name\":\"transfer-encoding\",\"description\":\"The form of encoding used to safely transfer the entity to the user. Currently defined methods are: chunked, compress, deflate, gzip, identity.\",\"value\":\"chunked\",\"key\":\"transfer-encoding\"},{\"name\":\"content-type\",\"value\":\"application/json;charset\\u003dUTF-8\",\"key\":\"content-type\"}],\"body\":\"{\\n    \\\"code\\\": 0, //response code\\n    \\\"msg\\\": \\\"\\\", //message\\n    \\\"data\\\": { //response data\\n        \\\"id\\\": 0, //user id\\n        /**\\n         * user type\\n         * 1 :administration\\n         * 2 :a person, an animal or a plant\\n         * 3 :Anonymous visitor\\n         */\\n        \\\"type\\\": 0,\\n        \\\"name\\\": \\\"\\\", //user name\\n        \\\"age\\\": 0, //user age\\n        \\\"sex\\\": 0,\\n        \\\"birthDay\\\": \\\"\\\", //user birthDay\\n        \\\"regtime\\\": \\\"\\\" //user regtime\\n    }\\n}\",\"status\":\"OK\"}],\"name\":\"update user info\",\"event\":[{\"listen\":\"prerequest\",\"script\":{\"type\":\"text/javascript\",\"exec\":[\"pm.environment.set(\\\"token\\\", \\\"123456\\\");\"]}},{\"listen\":\"test\",\"script\":{\"type\":\"text/javascript\",\"exec\":[\"pm.test(\\\"Successful POST request\\\", function () {\",\"pm.expect(pm.response.code).to.be.oneOf([201,202]);\",\"});\"]}}]},{\"request\":{\"method\":\"POST\",\"description\":\"\",\"header\":[{\"key\":\"Content-Type\",\"value\":\"application/json\",\"type\":\"text\",\"description\":\"\"},{\"key\":\"token\",\"value\":\"\",\"type\":\"text\",\"description\":\"auth token\"}],\"body\":{\"mode\":\"raw\",\"options\":{\"raw\":{\"language\":\"json\"}},\"raw\":\"{\\n  \\\"id\\\": 0,\\n  \\\"type\\\": 0,\\n  \\\"name\\\": \\\"\\\",\\n  \\\"age\\\": 0,\\n  \\\"sex\\\": 0,\\n  \\\"birthDay\\\": \\\"\\\",\\n  \\\"regtime\\\": \\\"\\\"\\n}\"},\"url\":{\"path\":[\"user\",\"add\"],\"query\":[],\"host\":\"{{test_default}}\",\"raw\":\"{{test_default}}/user/add\"}},\"response\":[{\"originalRequest\":{\"method\":\"POST\",\"description\":\"\",\"header\":[{\"key\":\"Content-Type\",\"value\":\"application/json\",\"type\":\"text\",\"description\":\"\"},{\"key\":\"token\",\"value\":\"\",\"type\":\"text\",\"description\":\"auth token\"}],\"body\":{\"mode\":\"raw\",\"options\":{\"raw\":{\"language\":\"json\"}},\"raw\":\"{\\n  \\\"id\\\": 0,\\n  \\\"type\\\": 0,\\n  \\\"name\\\": \\\"\\\",\\n  \\\"age\\\": 0,\\n  \\\"sex\\\": 0,\\n  \\\"birthDay\\\": \\\"\\\",\\n  \\\"regtime\\\": \\\"\\\"\\n}\"},\"url\":{\"query\":[],\"host\":\"{{test_default}}\"}},\"_postman_previewlanguage\":\"json\",\"code\":200,\"_postman_previewtype\":\"text\",\"responseTime\":50,\"name\":\"create an user-Example\",\"header\":[{\"name\":\"date\",\"key\":\"date\",\"value\":\"$date\",\"description\":\"The date and time that the message was sent\"},{\"name\":\"server\",\"key\":\"server\",\"value\":\"Apache-Coyote/1.1\",\"description\":\"A name for the server\"},{\"name\":\"transfer-encoding\",\"key\":\"transfer-encoding\",\"value\":\"chunked\",\"description\":\"The form of encoding used to safely transfer the entity to the user. Currently defined methods are: chunked, compress, deflate, gzip, identity.\"},{\"name\":\"content-type\",\"key\":\"content-type\",\"value\":\"application/json;charset\\u003dUTF-8\"}],\"body\":\"{\\n  \\\"code\\\": 0,\\n  \\\"msg\\\": \\\"\\\",\\n  \\\"data\\\": {\\n    \\\"id\\\": 0,\\n    \\\"type\\\": 0,\\n    \\\"name\\\": \\\"\\\",\\n    \\\"age\\\": 0,\\n    \\\"sex\\\": 0,\\n    \\\"birthDay\\\": \\\"\\\",\\n    \\\"regtime\\\": \\\"\\\"\\n  }\\n}\",\"status\":\"OK\"}],\"name\":\"create an user\",\"event\":[{\"listen\":\"prerequest\",\"script\":{\"exec\":[\"pm.environment.set(\\\"token\\\", \\\"123456\\\");\"],\"type\":\"text/javascript\"}},{\"listen\":\"test\",\"script\":{\"exec\":[\"pm.test(\\\"Successful POST request\\\", function () {\",\"pm.expect(pm.response.code).to.be.oneOf([201,202]);\",\"});\"],\"type\":\"text/javascript\"}}]},{\"request\":{\"method\":\"PUT\",\"description\":\"\",\"header\":[{\"key\":\"Content-Type\",\"value\":\"multipart/form-data\",\"type\":\"text\",\"description\":\"\"},{\"key\":\"token\",\"value\":\"\",\"type\":\"text\",\"description\":\"auth token\"}],\"body\":{\"mode\":\"formdata\",\"formdata\":[{\"key\":\"id\",\"type\":\"text\",\"description\":\"user id\"},{\"key\":\"type\",\"type\":\"text\",\"description\":\"user type\\n1 :administration\\n2 :a person, an animal or a plant\\n3 :Anonymous visitor\"},{\"key\":\"name\",\"type\":\"text\",\"description\":\"user name\"},{\"key\":\"age\",\"type\":\"text\",\"description\":\"user age\"},{\"key\":\"sex\",\"type\":\"text\",\"description\":\"\"},{\"key\":\"birthDay\",\"type\":\"text\",\"description\":\"user birthDay\"},{\"key\":\"regtime\",\"type\":\"text\",\"description\":\"user regtime\"}]},\"url\":{\"path\":[\"user\",\"update\"],\"query\":[],\"host\":\"{{test_default}}\",\"raw\":\"{{test_default}}/user/update\"}},\"response\":[{\"originalRequest\":{\"method\":\"PUT\",\"description\":\"\",\"header\":[{\"key\":\"Content-Type\",\"value\":\"multipart/form-data\",\"type\":\"text\",\"description\":\"\"},{\"key\":\"token\",\"value\":\"\",\"type\":\"text\",\"description\":\"auth token\"}],\"body\":{\"mode\":\"formdata\",\"formdata\":[{\"key\":\"id\",\"type\":\"text\",\"description\":\"user id\"},{\"key\":\"type\",\"type\":\"text\",\"description\":\"user type\\n1 :administration\\n2 :a person, an animal or a plant\\n3 :Anonymous visitor\"},{\"key\":\"name\",\"type\":\"text\",\"description\":\"user name\"},{\"key\":\"age\",\"type\":\"text\",\"description\":\"user age\"},{\"key\":\"sex\",\"type\":\"text\",\"description\":\"\"},{\"key\":\"birthDay\",\"type\":\"text\",\"description\":\"user birthDay\"},{\"key\":\"regtime\",\"type\":\"text\",\"description\":\"user regtime\"}]},\"url\":{\"path\":[\"user\",\"update\"],\"query\":[],\"host\":\"{{test_default}}\",\"raw\":\"{{test_default}}/user/update\"}},\"_postman_previewlanguage\":\"json\",\"code\":200,\"_postman_previewtype\":\"text\",\"responseTime\":50,\"name\":\"update user info-Example\",\"header\":[{\"name\":\"date\",\"key\":\"date\",\"value\":\"$date\",\"description\":\"The date and time that the message was sent\"},{\"name\":\"server\",\"key\":\"server\",\"value\":\"Apache-Coyote/1.1\",\"description\":\"A name for the server\"},{\"name\":\"transfer-encoding\",\"key\":\"transfer-encoding\",\"value\":\"chunked\",\"description\":\"The form of encoding used to safely transfer the entity to the user. Currently defined methods are: chunked, compress, deflate, gzip, identity.\"},{\"name\":\"content-type\",\"key\":\"content-type\",\"value\":\"application/json;charset\\u003dUTF-8\"}],\"body\":\"{\\n  \\\"code\\\": 0,\\n  \\\"msg\\\": \\\"\\\",\\n  \\\"data\\\": {\\n    \\\"id\\\": 0,\\n    \\\"type\\\": 0,\\n    \\\"name\\\": \\\"\\\",\\n    \\\"age\\\": 0,\\n    \\\"sex\\\": 0,\\n    \\\"birthDay\\\": \\\"\\\",\\n    \\\"regtime\\\": \\\"\\\"\\n  }\\n}\",\"status\":\"OK\"}],\"name\":\"update user info\",\"event\":[{\"listen\":\"prerequest\",\"script\":{\"exec\":[\"pm.environment.set(\\\"token\\\", \\\"123456\\\");\"],\"type\":\"text/javascript\"}},{\"listen\":\"test\",\"script\":{\"exec\":[\"pm.test(\\\"Successful POST request\\\", function () {\",\"pm.expect(pm.response.code).to.be.oneOf([201,202]);\",\"});\"],\"type\":\"text/javascript\"}}]},{\"request\":{\"method\":\"GET\",\"description\":\"\",\"header\":[{\"key\":\"token\",\"value\":\"\",\"type\":\"text\",\"description\":\"auth token\"}],\"url\":{\"path\":[\"user\",\"ctrl\",\"name\"],\"query\":[],\"host\":\"{{test_default}}\",\"raw\":\"{{test_default}}/user/ctrl/name\"}},\"response\":[{\"originalRequest\":{\"method\":\"GET\",\"description\":\"\",\"header\":[{\"key\":\"token\",\"value\":\"\",\"type\":\"text\",\"description\":\"auth token\"}],\"url\":{\"path\":[\"user\",\"ctrl\",\"name\"],\"query\":[],\"host\":\"{{test_default}}\",\"raw\":\"{{test_default}}/user/ctrl/name\"}},\"_postman_previewlanguage\":\"json\",\"code\":200,\"_postman_previewtype\":\"text\",\"responseTime\":50,\"name\":\"current ctrl name-Example\",\"header\":[{\"name\":\"date\",\"key\":\"date\",\"value\":\"$date\",\"description\":\"The date and time that the message was sent\"},{\"name\":\"server\",\"key\":\"server\",\"value\":\"Apache-Coyote/1.1\",\"description\":\"A name for the server\"},{\"name\":\"transfer-encoding\",\"key\":\"transfer-encoding\",\"value\":\"chunked\",\"description\":\"The form of encoding used to safely transfer the entity to the user. Currently defined methods are: chunked, compress, deflate, gzip, identity.\"},{\"name\":\"content-type\",\"key\":\"content-type\",\"value\":\"application/json;charset\\u003dUTF-8\"}],\"body\":\"\",\"status\":\"OK\"}],\"name\":\"current ctrl name\",\"event\":[{\"listen\":\"prerequest\",\"script\":{\"exec\":[\"pm.environment.set(\\\"token\\\", \\\"123456\\\");\"],\"type\":\"text/javascript\"}},{\"listen\":\"test\",\"script\":{\"exec\":[\"pm.test(\\\"Successful POST request\\\", function () {\",\"pm.expect(pm.response.code).to.be.oneOf([201,202]);\",\"});\"],\"type\":\"text/javascript\"}}]}],\"name\":\"apis about user\",\"description\":\"apis about user\\naccess user info\"},{\"item\":[{\"request\":{\"method\":\"GET\",\"description\":\"\",\"header\":[{\"key\":\"token\",\"value\":\"\",\"type\":\"text\",\"description\":\"auth token\"}],\"url\":{\"path\":[\"user\",\"get\",\":id\"],\"query\":[{\"key\":\"id\",\"value\":\"0\",\"equals\":true,\"description\":\"user id\"}],\"host\":\"{{test_default}}\",\"raw\":\"{{test_default}}/user/get/{id}\"}},\"response\":[{\"originalRequest\":{\"method\":\"GET\",\"description\":\"\",\"header\":[{\"key\":\"token\",\"value\":\"\",\"type\":\"text\",\"description\":\"auth token\"}],\"url\":{\"path\":[\"user\",\"get\",\":id\"],\"query\":[{\"key\":\"id\",\"value\":\"0\",\"equals\":true,\"description\":\"user id\"}],\"host\":\"{{test_default}}\",\"raw\":\"{{test_default}}/user/get/{id}\"}},\"_postman_previewlanguage\":\"json\",\"code\":200,\"_postman_previewtype\":\"text\",\"responseTime\":50,\"name\":\"get user info-Example\",\"header\":[{\"name\":\"date\",\"key\":\"date\",\"value\":\"$date\",\"description\":\"The date and time that the message was sent\"},{\"name\":\"server\",\"key\":\"server\",\"value\":\"Apache-Coyote/1.1\",\"description\":\"A name for the server\"},{\"name\":\"transfer-encoding\",\"key\":\"transfer-encoding\",\"value\":\"chunked\",\"description\":\"The form of encoding used to safely transfer the entity to the user. Currently defined methods are: chunked, compress, deflate, gzip, identity.\"},{\"name\":\"content-type\",\"key\":\"content-type\",\"value\":\"application/json;charset\\u003dUTF-8\"}],\"body\":\"{\\n  \\\"code\\\": 0,\\n  \\\"msg\\\": \\\"success\\\",\\n  \\\"data\\\": {\\n    \\\"id\\\": 0,\\n    \\\"type\\\": 0,\\n    \\\"name\\\": \\\"Tony Stark\\\",\\n    \\\"age\\\": 45,\\n    \\\"sex\\\": 0,\\n    \\\"birthDay\\\": \\\"\\\",\\n    \\\"regtime\\\": \\\"\\\"\\n  }\\n}\",\"status\":\"OK\"}],\"name\":\"get user info\",\"event\":[{\"listen\":\"prerequest\",\"script\":{\"exec\":[\"pm.environment.set(\\\"token\\\", \\\"123456\\\");\"],\"type\":\"text/javascript\"}},{\"listen\":\"test\",\"script\":{\"exec\":[\"pm.test(\\\"Successful POST request\\\", function () {\",\"pm.expect(pm.response.code).to.be.oneOf([201,202]);\",\"});\"],\"type\":\"text/javascript\"}}]}],\"name\":\"update-apis\",\"description\":\"\"}],\"info\":{\"schema\":\"https://schema.getpostman.com/json/collection/v2.1.0/collection.json\",\"name\":\"test_default-$LOCAL_TIME_RAW_STRING\",\"description\":\"exported at $LOCAL_TIME_YMS_STRING\"}}",
            collectionInfo.toJson()
        )
    }
}